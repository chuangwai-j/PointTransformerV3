[2025-09-19 12:59:56,349 INFO train.py line 29 7075] 使用配置文件: configs/wind_shear/pointtransformer_v3.yaml
[2025-09-19 12:59:56,349 INFO train.py line 30 7075] 配置详情: {'model': {'type': 'PT-v3m1', 'encoder_depth': [2, 2, 6, 2], 'embed_dim': 32, 'num_heads': 4, 'cloud_size': 8192, 'in_channels': 9, 'num_classes': 2}, 'data': {'train': {'type': 'WindShearDataset', 'split': 'train', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'GridSample', 'grid_size': 10.0}, {'type': 'ToTensor'}]}, 'val': {'type': 'WindShearDataset', 'split': 'val', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'GridSample', 'grid_size': 10.0}, {'type': 'ToTensor'}]}, 'test': {'type': 'WindShearDataset', 'split': 'test', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'GridSample', 'grid_size': 10.0}, {'type': 'ToTensor'}]}}, 'train': {'epochs': 100, 'optimizer': {'type': 'AdamW', 'lr': 0.001, 'weight_decay': 0.0001}, 'scheduler': {'type': 'CosineAnnealingLR', 'T_max': 100}, 'batch_size': 2, 'num_workers': 4}, 'evaluation': {'interval': 1}, 'checkpoint': {'interval': 5}, 'log': {'interval': 50}}
[2025-09-19 12:59:56,648 INFO train.py line 34 7075] 使用设备: cuda
[2025-09-19 12:59:57,121 INFO train.py line 71 7075] 训练集样本数: 8935, 验证集样本数: 2130
[2025-09-19 13:09:15,217 INFO train.py line 29 10053] 使用配置文件: configs/wind_shear/pointtransformer_v3.yaml
[2025-09-19 13:09:15,217 INFO train.py line 30 10053] 配置详情: {'model': {'type': 'PT-v3m1', 'in_channels': 9, 'num_classes': 2, 'cls_mode': False, 'order': '("z", "z-trans")', 'pdnorm_bn': False, 'pdnorm_ln': False, 'enc_depths': [2, 2, 6, 2], 'enc_channels': [32, 64, 128, 256], 'enc_num_head': [2, 4, 8, 16], 'stride': '(2, 2, 2)', 'enc_patch_size': '(48, 48, 48, 48)', 'dec_depths': [2, 2, 2], 'dec_channels': [64, 64, 128], 'dec_num_head': [4, 4, 8], 'dec_patch_size': '(48, 48, 48)', 'mlp_ratio': 4, 'qkv_bias': True, 'drop_path': 0.3, 'enable_flash': False}, 'data': {'train': {'type': 'WindShearDataset', 'split': 'train', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'GridSample', 'grid_size': 10.0}, {'type': 'ToTensor'}]}, 'val': {'type': 'WindShearDataset', 'split': 'val', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'GridSample', 'grid_size': 10.0}, {'type': 'ToTensor'}]}, 'test': {'type': 'WindShearDataset', 'split': 'test', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'GridSample', 'grid_size': 10.0}, {'type': 'ToTensor'}]}}, 'train': {'epochs': 100, 'optimizer': {'type': 'AdamW', 'lr': 0.001, 'weight_decay': 0.0001}, 'scheduler': {'type': 'CosineAnnealingLR', 'T_max': 100}, 'batch_size': 2, 'num_workers': 4}, 'evaluation': {'interval': 1}, 'checkpoint': {'interval': 5}, 'log': {'interval': 50}}
[2025-09-19 13:09:15,395 INFO train.py line 34 10053] 使用设备: cuda
[2025-09-19 13:09:15,915 INFO train.py line 71 10053] 训练集样本数: 8935, 验证集样本数: 2130
[2025-09-19 13:14:05,931 INFO train.py line 29 11608] 使用配置文件: configs/wind_shear/pointtransformer_v3.yaml
[2025-09-19 13:14:05,931 INFO train.py line 30 11608] 配置详情: {'model': {'type': 'PT-v3m1', 'in_channels': 9, 'num_classes': 2, 'cls_mode': False, 'order': '("z", "z-trans")', 'pdnorm_bn': False, 'pdnorm_ln': False, 'enc_depths': [2, 2, 6, 2], 'enc_channels': [32, 64, 128, 256], 'enc_num_head': [2, 4, 8, 16], 'stride': '(2, 2, 2)', 'enc_patch_size': '(48, 48, 48, 48)', 'dec_depths': [2, 2, 2], 'dec_channels': [64, 64, 128], 'dec_num_head': [4, 4, 8], 'dec_patch_size': '(48, 48, 48)', 'mlp_ratio': 4, 'qkv_bias': True, 'drop_path': 0.3, 'enable_flash': False}, 'data': {'train': {'type': 'WindShearDataset', 'split': 'train', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'GridSample', 'grid_size': 10.0}, {'type': 'ToTensor'}]}, 'val': {'type': 'WindShearDataset', 'split': 'val', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'GridSample', 'grid_size': 10.0}, {'type': 'ToTensor'}]}, 'test': {'type': 'WindShearDataset', 'split': 'test', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'GridSample', 'grid_size': 10.0}, {'type': 'ToTensor'}]}}, 'train': {'epochs': 100, 'optimizer': {'type': 'AdamW', 'lr': 0.001, 'weight_decay': 0.0001}, 'scheduler': {'type': 'CosineAnnealingLR', 'T_max': 100}, 'batch_size': 2, 'num_workers': 4}, 'evaluation': {'interval': 1}, 'checkpoint': {'interval': 5}, 'log': {'interval': 50}}
[2025-09-19 13:14:04,279 INFO train.py line 34 11608] 使用设备: cuda
[2025-09-19 13:14:04,719 INFO train.py line 71 11608] 训练集样本数: 8935, 验证集样本数: 2130
[2025-09-19 13:17:41,755 INFO train.py line 29 12772] 使用配置文件: configs/wind_shear/pointtransformer_v3.yaml
[2025-09-19 13:17:41,755 INFO train.py line 30 12772] 配置详情: {'model': {'type': 'PT-v3m1', 'in_channels': 9, 'num_classes': 2, 'cls_mode': False, 'order': ['z', 'z-trans'], 'pdnorm_bn': False, 'pdnorm_ln': False, 'enc_depths': [2, 2, 6, 2], 'enc_channels': [32, 64, 128, 256], 'enc_num_head': [2, 4, 8, 16], 'stride': [2, 2, 2], 'enc_patch_size': [48, 48, 48, 48], 'dec_depths': [2, 2, 2], 'dec_channels': [64, 64, 128], 'dec_num_head': [4, 4, 8], 'dec_patch_size': [48, 48, 48], 'mlp_ratio': 4, 'qkv_bias': True, 'drop_path': 0.3, 'enable_flash': False}, 'data': {'train': {'type': 'WindShearDataset', 'split': 'train', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'GridSample', 'grid_size': 10.0}, {'type': 'ToTensor'}]}, 'val': {'type': 'WindShearDataset', 'split': 'val', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'GridSample', 'grid_size': 10.0}, {'type': 'ToTensor'}]}, 'test': {'type': 'WindShearDataset', 'split': 'test', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'GridSample', 'grid_size': 10.0}, {'type': 'ToTensor'}]}}, 'train': {'epochs': 100, 'optimizer': {'type': 'AdamW', 'lr': 0.001, 'weight_decay': 0.0001}, 'scheduler': {'type': 'CosineAnnealingLR', 'T_max': 100}, 'batch_size': 2, 'num_workers': 4}, 'evaluation': {'interval': 1}, 'checkpoint': {'interval': 5}, 'log': {'interval': 50}}
[2025-09-19 13:17:42,090 INFO train.py line 34 12772] 使用设备: cuda
[2025-09-19 13:17:42,412 INFO train.py line 71 12772] 训练集样本数: 8935, 验证集样本数: 2130
[2025-09-19 13:17:42,822 INFO train.py line 78 12772] 模型结构: PointTransformerV3(
  (embedding): Embedding(
    (stem): PointSequential(
      (conv): SubMConv3d(9, 32, kernel_size=[5, 5, 5], stride=[1, 1, 1], padding=[1, 1, 1], dilation=[1, 1, 1], output_padding=[0, 0, 0], bias=False, algo=ConvAlgo.Native)
      (norm): BatchNorm1d(32, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
      (act): GELU(approximate='none')
    )
  )
  (enc): PointSequential(
    (enc0): PointSequential(
      (block0): Block(
        (cpe): PointSequential(
          (0): SubMConv3d(32, 32, kernel_size=[3, 3, 3], stride=[1, 1, 1], padding=[0, 0, 0], dilation=[1, 1, 1], output_padding=[0, 0, 0], algo=ConvAlgo.MaskImplicitGemm)
          (1): Linear(in_features=32, out_features=32, bias=True)
          (2): LayerNorm((32,), eps=1e-05, elementwise_affine=True)
        )
        (norm1): PointSequential(
          (0): LayerNorm((32,), eps=1e-05, elementwise_affine=True)
        )
        (attn): SerializedAttention(
          (attn_drop): Dropout(p=0.0, inplace=False)
          (qkv): Linear(in_features=32, out_features=96, bias=True)
          (proj): Linear(in_features=32, out_features=32, bias=True)
          (proj_drop): Dropout(p=0.0, inplace=False)
          (softmax): Softmax(dim=-1)
        )
        (norm2): PointSequential(
          (0): LayerNorm((32,), eps=1e-05, elementwise_affine=True)
        )
        (mlp): PointSequential(
          (0): MLP(
            (fc1): Linear(in_features=32, out_features=128, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=128, out_features=32, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (drop_path): PointSequential(
          (0): Identity()
        )
      )
      (block1): Block(
        (cpe): PointSequential(
          (0): SubMConv3d(32, 32, kernel_size=[3, 3, 3], stride=[1, 1, 1], padding=[0, 0, 0], dilation=[1, 1, 1], output_padding=[0, 0, 0], algo=ConvAlgo.MaskImplicitGemm)
          (1): Linear(in_features=32, out_features=32, bias=True)
          (2): LayerNorm((32,), eps=1e-05, elementwise_affine=True)
        )
        (norm1): PointSequential(
          (0): LayerNorm((32,), eps=1e-05, elementwise_affine=True)
        )
        (attn): SerializedAttention(
          (attn_drop): Dropout(p=0.0, inplace=False)
          (qkv): Linear(in_features=32, out_features=96, bias=True)
          (proj): Linear(in_features=32, out_features=32, bias=True)
          (proj_drop): Dropout(p=0.0, inplace=False)
          (softmax): Softmax(dim=-1)
        )
        (norm2): PointSequential(
          (0): LayerNorm((32,), eps=1e-05, elementwise_affine=True)
        )
        (mlp): PointSequential(
          (0): MLP(
            (fc1): Linear(in_features=32, out_features=128, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=128, out_features=32, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (drop_path): PointSequential(
          (0): DropPath(drop_prob=0.027)
        )
      )
    )
    (enc1): PointSequential(
      (down): SerializedPooling(
        (proj): Linear(in_features=32, out_features=64, bias=True)
        (norm): PointSequential(
          (0): BatchNorm1d(64, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
        )
        (act): PointSequential(
          (0): GELU(approximate='none')
        )
      )
      (block0): Block(
        (cpe): PointSequential(
          (0): SubMConv3d(64, 64, kernel_size=[3, 3, 3], stride=[1, 1, 1], padding=[0, 0, 0], dilation=[1, 1, 1], output_padding=[0, 0, 0], algo=ConvAlgo.MaskImplicitGemm)
          (1): Linear(in_features=64, out_features=64, bias=True)
          (2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        )
        (norm1): PointSequential(
          (0): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        )
        (attn): SerializedAttention(
          (attn_drop): Dropout(p=0.0, inplace=False)
          (qkv): Linear(in_features=64, out_features=192, bias=True)
          (proj): Linear(in_features=64, out_features=64, bias=True)
          (proj_drop): Dropout(p=0.0, inplace=False)
          (softmax): Softmax(dim=-1)
        )
        (norm2): PointSequential(
          (0): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        )
        (mlp): PointSequential(
          (0): MLP(
            (fc1): Linear(in_features=64, out_features=256, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=256, out_features=64, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (drop_path): PointSequential(
          (0): DropPath(drop_prob=0.055)
        )
      )
      (block1): Block(
        (cpe): PointSequential(
          (0): SubMConv3d(64, 64, kernel_size=[3, 3, 3], stride=[1, 1, 1], padding=[0, 0, 0], dilation=[1, 1, 1], output_padding=[0, 0, 0], algo=ConvAlgo.MaskImplicitGemm)
          (1): Linear(in_features=64, out_features=64, bias=True)
          (2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        )
        (norm1): PointSequential(
          (0): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        )
        (attn): SerializedAttention(
          (attn_drop): Dropout(p=0.0, inplace=False)
          (qkv): Linear(in_features=64, out_features=192, bias=True)
          (proj): Linear(in_features=64, out_features=64, bias=True)
          (proj_drop): Dropout(p=0.0, inplace=False)
          (softmax): Softmax(dim=-1)
        )
        (norm2): PointSequential(
          (0): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        )
        (mlp): PointSequential(
          (0): MLP(
            (fc1): Linear(in_features=64, out_features=256, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=256, out_features=64, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (drop_path): PointSequential(
          (0): DropPath(drop_prob=0.082)
        )
      )
    )
    (enc2): PointSequential(
      (down): SerializedPooling(
        (proj): Linear(in_features=64, out_features=128, bias=True)
        (norm): PointSequential(
          (0): BatchNorm1d(128, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
        )
        (act): PointSequential(
          (0): GELU(approximate='none')
        )
      )
      (block0): Block(
        (cpe): PointSequential(
          (0): SubMConv3d(128, 128, kernel_size=[3, 3, 3], stride=[1, 1, 1], padding=[0, 0, 0], dilation=[1, 1, 1], output_padding=[0, 0, 0], algo=ConvAlgo.MaskImplicitGemm)
          (1): Linear(in_features=128, out_features=128, bias=True)
          (2): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
        )
        (norm1): PointSequential(
          (0): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
        )
        (attn): SerializedAttention(
          (attn_drop): Dropout(p=0.0, inplace=False)
          (qkv): Linear(in_features=128, out_features=384, bias=True)
          (proj): Linear(in_features=128, out_features=128, bias=True)
          (proj_drop): Dropout(p=0.0, inplace=False)
          (softmax): Softmax(dim=-1)
        )
        (norm2): PointSequential(
          (0): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
        )
        (mlp): PointSequential(
          (0): MLP(
            (fc1): Linear(in_features=128, out_features=512, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=512, out_features=128, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (drop_path): PointSequential(
          (0): DropPath(drop_prob=0.109)
        )
      )
      (block1): Block(
        (cpe): PointSequential(
          (0): SubMConv3d(128, 128, kernel_size=[3, 3, 3], stride=[1, 1, 1], padding=[0, 0, 0], dilation=[1, 1, 1], output_padding=[0, 0, 0], algo=ConvAlgo.MaskImplicitGemm)
          (1): Linear(in_features=128, out_features=128, bias=True)
          (2): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
        )
        (norm1): PointSequential(
          (0): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
        )
        (attn): SerializedAttention(
          (attn_drop): Dropout(p=0.0, inplace=False)
          (qkv): Linear(in_features=128, out_features=384, bias=True)
          (proj): Linear(in_features=128, out_features=128, bias=True)
          (proj_drop): Dropout(p=0.0, inplace=False)
          (softmax): Softmax(dim=-1)
        )
        (norm2): PointSequential(
          (0): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
        )
        (mlp): PointSequential(
          (0): MLP(
            (fc1): Linear(in_features=128, out_features=512, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=512, out_features=128, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (drop_path): PointSequential(
          (0): DropPath(drop_prob=0.136)
        )
      )
      (block2): Block(
        (cpe): PointSequential(
          (0): SubMConv3d(128, 128, kernel_size=[3, 3, 3], stride=[1, 1, 1], padding=[0, 0, 0], dilation=[1, 1, 1], output_padding=[0, 0, 0], algo=ConvAlgo.MaskImplicitGemm)
          (1): Linear(in_features=128, out_features=128, bias=True)
          (2): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
        )
        (norm1): PointSequential(
          (0): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
        )
        (attn): SerializedAttention(
          (attn_drop): Dropout(p=0.0, inplace=False)
          (qkv): Linear(in_features=128, out_features=384, bias=True)
          (proj): Linear(in_features=128, out_features=128, bias=True)
          (proj_drop): Dropout(p=0.0, inplace=False)
          (softmax): Softmax(dim=-1)
        )
        (norm2): PointSequential(
          (0): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
        )
        (mlp): PointSequential(
          (0): MLP(
            (fc1): Linear(in_features=128, out_features=512, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=512, out_features=128, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (drop_path): PointSequential(
          (0): DropPath(drop_prob=0.164)
        )
      )
      (block3): Block(
        (cpe): PointSequential(
          (0): SubMConv3d(128, 128, kernel_size=[3, 3, 3], stride=[1, 1, 1], padding=[0, 0, 0], dilation=[1, 1, 1], output_padding=[0, 0, 0], algo=ConvAlgo.MaskImplicitGemm)
          (1): Linear(in_features=128, out_features=128, bias=True)
          (2): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
        )
        (norm1): PointSequential(
          (0): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
        )
        (attn): SerializedAttention(
          (attn_drop): Dropout(p=0.0, inplace=False)
          (qkv): Linear(in_features=128, out_features=384, bias=True)
          (proj): Linear(in_features=128, out_features=128, bias=True)
          (proj_drop): Dropout(p=0.0, inplace=False)
          (softmax): Softmax(dim=-1)
        )
        (norm2): PointSequential(
          (0): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
        )
        (mlp): PointSequential(
          (0): MLP(
            (fc1): Linear(in_features=128, out_features=512, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=512, out_features=128, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (drop_path): PointSequential(
          (0): DropPath(drop_prob=0.191)
        )
      )
      (block4): Block(
        (cpe): PointSequential(
          (0): SubMConv3d(128, 128, kernel_size=[3, 3, 3], stride=[1, 1, 1], padding=[0, 0, 0], dilation=[1, 1, 1], output_padding=[0, 0, 0], algo=ConvAlgo.MaskImplicitGemm)
          (1): Linear(in_features=128, out_features=128, bias=True)
          (2): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
        )
        (norm1): PointSequential(
          (0): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
        )
        (attn): SerializedAttention(
          (attn_drop): Dropout(p=0.0, inplace=False)
          (qkv): Linear(in_features=128, out_features=384, bias=True)
          (proj): Linear(in_features=128, out_features=128, bias=True)
          (proj_drop): Dropout(p=0.0, inplace=False)
          (softmax): Softmax(dim=-1)
        )
        (norm2): PointSequential(
          (0): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
        )
        (mlp): PointSequential(
          (0): MLP(
            (fc1): Linear(in_features=128, out_features=512, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=512, out_features=128, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (drop_path): PointSequential(
          (0): DropPath(drop_prob=0.218)
        )
      )
      (block5): Block(
        (cpe): PointSequential(
          (0): SubMConv3d(128, 128, kernel_size=[3, 3, 3], stride=[1, 1, 1], padding=[0, 0, 0], dilation=[1, 1, 1], output_padding=[0, 0, 0], algo=ConvAlgo.MaskImplicitGemm)
          (1): Linear(in_features=128, out_features=128, bias=True)
          (2): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
        )
        (norm1): PointSequential(
          (0): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
        )
        (attn): SerializedAttention(
          (attn_drop): Dropout(p=0.0, inplace=False)
          (qkv): Linear(in_features=128, out_features=384, bias=True)
          (proj): Linear(in_features=128, out_features=128, bias=True)
          (proj_drop): Dropout(p=0.0, inplace=False)
          (softmax): Softmax(dim=-1)
        )
        (norm2): PointSequential(
          (0): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
        )
        (mlp): PointSequential(
          (0): MLP(
            (fc1): Linear(in_features=128, out_features=512, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=512, out_features=128, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (drop_path): PointSequential(
          (0): DropPath(drop_prob=0.245)
        )
      )
    )
    (enc3): PointSequential(
      (down): SerializedPooling(
        (proj): Linear(in_features=128, out_features=256, bias=True)
        (norm): PointSequential(
          (0): BatchNorm1d(256, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
        )
        (act): PointSequential(
          (0): GELU(approximate='none')
        )
      )
      (block0): Block(
        (cpe): PointSequential(
          (0): SubMConv3d(256, 256, kernel_size=[3, 3, 3], stride=[1, 1, 1], padding=[0, 0, 0], dilation=[1, 1, 1], output_padding=[0, 0, 0], algo=ConvAlgo.MaskImplicitGemm)
          (1): Linear(in_features=256, out_features=256, bias=True)
          (2): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
        )
        (norm1): PointSequential(
          (0): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
        )
        (attn): SerializedAttention(
          (attn_drop): Dropout(p=0.0, inplace=False)
          (qkv): Linear(in_features=256, out_features=768, bias=True)
          (proj): Linear(in_features=256, out_features=256, bias=True)
          (proj_drop): Dropout(p=0.0, inplace=False)
          (softmax): Softmax(dim=-1)
        )
        (norm2): PointSequential(
          (0): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
        )
        (mlp): PointSequential(
          (0): MLP(
            (fc1): Linear(in_features=256, out_features=1024, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1024, out_features=256, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (drop_path): PointSequential(
          (0): DropPath(drop_prob=0.273)
        )
      )
      (block1): Block(
        (cpe): PointSequential(
          (0): SubMConv3d(256, 256, kernel_size=[3, 3, 3], stride=[1, 1, 1], padding=[0, 0, 0], dilation=[1, 1, 1], output_padding=[0, 0, 0], algo=ConvAlgo.MaskImplicitGemm)
          (1): Linear(in_features=256, out_features=256, bias=True)
          (2): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
        )
        (norm1): PointSequential(
          (0): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
        )
        (attn): SerializedAttention(
          (attn_drop): Dropout(p=0.0, inplace=False)
          (qkv): Linear(in_features=256, out_features=768, bias=True)
          (proj): Linear(in_features=256, out_features=256, bias=True)
          (proj_drop): Dropout(p=0.0, inplace=False)
          (softmax): Softmax(dim=-1)
        )
        (norm2): PointSequential(
          (0): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
        )
        (mlp): PointSequential(
          (0): MLP(
            (fc1): Linear(in_features=256, out_features=1024, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=1024, out_features=256, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (drop_path): PointSequential(
          (0): DropPath(drop_prob=0.300)
        )
      )
    )
  )
  (dec): PointSequential(
    (dec2): PointSequential(
      (up): SerializedUnpooling(
        (proj): PointSequential(
          (0): Linear(in_features=256, out_features=128, bias=True)
          (1): BatchNorm1d(128, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
          (2): GELU(approximate='none')
        )
        (proj_skip): PointSequential(
          (0): Linear(in_features=128, out_features=128, bias=True)
          (1): BatchNorm1d(128, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
          (2): GELU(approximate='none')
        )
      )
      (block0): Block(
        (cpe): PointSequential(
          (0): SubMConv3d(128, 128, kernel_size=[3, 3, 3], stride=[1, 1, 1], padding=[0, 0, 0], dilation=[1, 1, 1], output_padding=[0, 0, 0], algo=ConvAlgo.MaskImplicitGemm)
          (1): Linear(in_features=128, out_features=128, bias=True)
          (2): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
        )
        (norm1): PointSequential(
          (0): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
        )
        (attn): SerializedAttention(
          (attn_drop): Dropout(p=0.0, inplace=False)
          (qkv): Linear(in_features=128, out_features=384, bias=True)
          (proj): Linear(in_features=128, out_features=128, bias=True)
          (proj_drop): Dropout(p=0.0, inplace=False)
          (softmax): Softmax(dim=-1)
        )
        (norm2): PointSequential(
          (0): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
        )
        (mlp): PointSequential(
          (0): MLP(
            (fc1): Linear(in_features=128, out_features=512, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=512, out_features=128, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (drop_path): PointSequential(
          (0): DropPath(drop_prob=0.300)
        )
      )
      (block1): Block(
        (cpe): PointSequential(
          (0): SubMConv3d(128, 128, kernel_size=[3, 3, 3], stride=[1, 1, 1], padding=[0, 0, 0], dilation=[1, 1, 1], output_padding=[0, 0, 0], algo=ConvAlgo.MaskImplicitGemm)
          (1): Linear(in_features=128, out_features=128, bias=True)
          (2): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
        )
        (norm1): PointSequential(
          (0): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
        )
        (attn): SerializedAttention(
          (attn_drop): Dropout(p=0.0, inplace=False)
          (qkv): Linear(in_features=128, out_features=384, bias=True)
          (proj): Linear(in_features=128, out_features=128, bias=True)
          (proj_drop): Dropout(p=0.0, inplace=False)
          (softmax): Softmax(dim=-1)
        )
        (norm2): PointSequential(
          (0): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
        )
        (mlp): PointSequential(
          (0): MLP(
            (fc1): Linear(in_features=128, out_features=512, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=512, out_features=128, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (drop_path): PointSequential(
          (0): DropPath(drop_prob=0.240)
        )
      )
    )
    (dec1): PointSequential(
      (up): SerializedUnpooling(
        (proj): PointSequential(
          (0): Linear(in_features=128, out_features=64, bias=True)
          (1): BatchNorm1d(64, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
          (2): GELU(approximate='none')
        )
        (proj_skip): PointSequential(
          (0): Linear(in_features=64, out_features=64, bias=True)
          (1): BatchNorm1d(64, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
          (2): GELU(approximate='none')
        )
      )
      (block0): Block(
        (cpe): PointSequential(
          (0): SubMConv3d(64, 64, kernel_size=[3, 3, 3], stride=[1, 1, 1], padding=[0, 0, 0], dilation=[1, 1, 1], output_padding=[0, 0, 0], algo=ConvAlgo.MaskImplicitGemm)
          (1): Linear(in_features=64, out_features=64, bias=True)
          (2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        )
        (norm1): PointSequential(
          (0): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        )
        (attn): SerializedAttention(
          (attn_drop): Dropout(p=0.0, inplace=False)
          (qkv): Linear(in_features=64, out_features=192, bias=True)
          (proj): Linear(in_features=64, out_features=64, bias=True)
          (proj_drop): Dropout(p=0.0, inplace=False)
          (softmax): Softmax(dim=-1)
        )
        (norm2): PointSequential(
          (0): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        )
        (mlp): PointSequential(
          (0): MLP(
            (fc1): Linear(in_features=64, out_features=256, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=256, out_features=64, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (drop_path): PointSequential(
          (0): DropPath(drop_prob=0.180)
        )
      )
      (block1): Block(
        (cpe): PointSequential(
          (0): SubMConv3d(64, 64, kernel_size=[3, 3, 3], stride=[1, 1, 1], padding=[0, 0, 0], dilation=[1, 1, 1], output_padding=[0, 0, 0], algo=ConvAlgo.MaskImplicitGemm)
          (1): Linear(in_features=64, out_features=64, bias=True)
          (2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        )
        (norm1): PointSequential(
          (0): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        )
        (attn): SerializedAttention(
          (attn_drop): Dropout(p=0.0, inplace=False)
          (qkv): Linear(in_features=64, out_features=192, bias=True)
          (proj): Linear(in_features=64, out_features=64, bias=True)
          (proj_drop): Dropout(p=0.0, inplace=False)
          (softmax): Softmax(dim=-1)
        )
        (norm2): PointSequential(
          (0): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        )
        (mlp): PointSequential(
          (0): MLP(
            (fc1): Linear(in_features=64, out_features=256, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=256, out_features=64, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (drop_path): PointSequential(
          (0): DropPath(drop_prob=0.120)
        )
      )
    )
    (dec0): PointSequential(
      (up): SerializedUnpooling(
        (proj): PointSequential(
          (0): Linear(in_features=64, out_features=64, bias=True)
          (1): BatchNorm1d(64, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
          (2): GELU(approximate='none')
        )
        (proj_skip): PointSequential(
          (0): Linear(in_features=32, out_features=64, bias=True)
          (1): BatchNorm1d(64, eps=0.001, momentum=0.01, affine=True, track_running_stats=True)
          (2): GELU(approximate='none')
        )
      )
      (block0): Block(
        (cpe): PointSequential(
          (0): SubMConv3d(64, 64, kernel_size=[3, 3, 3], stride=[1, 1, 1], padding=[0, 0, 0], dilation=[1, 1, 1], output_padding=[0, 0, 0], algo=ConvAlgo.MaskImplicitGemm)
          (1): Linear(in_features=64, out_features=64, bias=True)
          (2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        )
        (norm1): PointSequential(
          (0): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        )
        (attn): SerializedAttention(
          (attn_drop): Dropout(p=0.0, inplace=False)
          (qkv): Linear(in_features=64, out_features=192, bias=True)
          (proj): Linear(in_features=64, out_features=64, bias=True)
          (proj_drop): Dropout(p=0.0, inplace=False)
          (softmax): Softmax(dim=-1)
        )
        (norm2): PointSequential(
          (0): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        )
        (mlp): PointSequential(
          (0): MLP(
            (fc1): Linear(in_features=64, out_features=256, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=256, out_features=64, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (drop_path): PointSequential(
          (0): DropPath(drop_prob=0.060)
        )
      )
      (block1): Block(
        (cpe): PointSequential(
          (0): SubMConv3d(64, 64, kernel_size=[3, 3, 3], stride=[1, 1, 1], padding=[0, 0, 0], dilation=[1, 1, 1], output_padding=[0, 0, 0], algo=ConvAlgo.MaskImplicitGemm)
          (1): Linear(in_features=64, out_features=64, bias=True)
          (2): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        )
        (norm1): PointSequential(
          (0): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        )
        (attn): SerializedAttention(
          (attn_drop): Dropout(p=0.0, inplace=False)
          (qkv): Linear(in_features=64, out_features=192, bias=True)
          (proj): Linear(in_features=64, out_features=64, bias=True)
          (proj_drop): Dropout(p=0.0, inplace=False)
          (softmax): Softmax(dim=-1)
        )
        (norm2): PointSequential(
          (0): LayerNorm((64,), eps=1e-05, elementwise_affine=True)
        )
        (mlp): PointSequential(
          (0): MLP(
            (fc1): Linear(in_features=64, out_features=256, bias=True)
            (act): GELU(approximate='none')
            (fc2): Linear(in_features=256, out_features=64, bias=True)
            (drop): Dropout(p=0.0, inplace=False)
          )
        )
        (drop_path): PointSequential(
          (0): Identity()
        )
      )
    )
  )
  (head): Linear(in_features=64, out_features=2, bias=True)
)
[2025-09-19 13:17:42,826 INFO train.py line 103 12772] 
===== Epoch 1/100 =====
[2025-09-19 13:23:39,930 INFO train.py line 29 14663] 使用配置文件: configs/wind_shear/pointtransformer_v3.yaml
[2025-09-19 13:23:39,930 INFO train.py line 30 14663] 配置详情: {'model': {'type': 'PT-v3m1', 'in_channels': 9, 'num_classes': 2, 'cls_mode': False, 'order': ['z', 'z-trans'], 'pdnorm_bn': False, 'pdnorm_ln': False, 'enc_depths': [2, 2, 6, 2], 'enc_channels': [32, 64, 128, 256], 'enc_num_head': [2, 4, 8, 16], 'stride': [2, 2, 2], 'enc_patch_size': [48, 48, 48, 48], 'dec_depths': [2, 2, 2], 'dec_channels': [64, 64, 128], 'dec_num_head': [4, 4, 8], 'dec_patch_size': [48, 48, 48], 'mlp_ratio': 4, 'qkv_bias': True, 'drop_path': 0.3, 'enable_flash': False}, 'data': {'train': {'type': 'WindShearDataset', 'split': 'train', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'GridSample', 'grid_size': 10.0}, {'type': 'ToTensor'}]}, 'val': {'type': 'WindShearDataset', 'split': 'val', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'GridSample', 'grid_size': 10.0}, {'type': 'ToTensor'}]}, 'test': {'type': 'WindShearDataset', 'split': 'test', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'GridSample', 'grid_size': 10.0}, {'type': 'ToTensor'}]}}, 'train': {'epochs': 100, 'optimizer': {'type': 'AdamW', 'lr': 0.001, 'weight_decay': 0.0001}, 'scheduler': {'type': 'CosineAnnealingLR', 'T_max': 100}, 'batch_size': 2, 'num_workers': 4}, 'evaluation': {'interval': 1}, 'checkpoint': {'interval': 5}, 'log': {'interval': 50}}
[2025-09-19 13:23:40,076 INFO train.py line 34 14663] 使用设备: cuda
[2025-09-19 13:27:03,602 INFO train.py line 29 15731] 使用配置文件: configs/wind_shear/pointtransformer_v3.yaml
[2025-09-19 13:27:03,602 INFO train.py line 30 15731] 配置详情: {'model': {'type': 'PT-v3m1', 'in_channels': 9, 'num_classes': 2, 'cls_mode': False, 'order': ['z', 'z-trans'], 'pdnorm_bn': False, 'pdnorm_ln': False, 'enc_depths': [2, 2, 6, 2], 'enc_channels': [32, 64, 128, 256], 'enc_num_head': [2, 4, 8, 16], 'stride': [2, 2, 2], 'enc_patch_size': [48, 48, 48, 48], 'dec_depths': [2, 2, 2], 'dec_channels': [64, 64, 128], 'dec_num_head': [4, 4, 8], 'dec_patch_size': [48, 48, 48], 'mlp_ratio': 4, 'qkv_bias': True, 'drop_path': 0.3, 'enable_flash': False}, 'data': {'train': {'type': 'WindShearDataset', 'split': 'train', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'GridSample', 'grid_size': 10.0}, {'type': 'ToTensor'}]}, 'val': {'type': 'WindShearDataset', 'split': 'val', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'GridSample', 'grid_size': 10.0}, {'type': 'ToTensor'}]}, 'test': {'type': 'WindShearDataset', 'split': 'test', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'GridSample', 'grid_size': 10.0}, {'type': 'ToTensor'}]}}, 'train': {'epochs': 100, 'optimizer': {'type': 'AdamW', 'lr': 0.001, 'weight_decay': 0.0001}, 'scheduler': {'type': 'CosineAnnealingLR', 'T_max': 100}, 'batch_size': 2, 'num_workers': 4}, 'evaluation': {'interval': 1}, 'checkpoint': {'interval': 5}, 'log': {'interval': 50}}
[2025-09-19 13:27:03,918 INFO train.py line 34 15731] 使用设备: cuda
[2025-09-19 13:27:04,462 INFO train.py line 71 15731] 训练集样本数: 8935, 验证集样本数: 2130
[2025-09-19 13:27:05,014 INFO train.py line 103 15731] 
===== Epoch 1/100 =====
[2025-09-19 13:53:42,177 INFO train.py line 27 21408] 使用配置文件: configs/wind_shear/pointtransformer_v3.yaml
[2025-09-19 13:53:42,177 INFO train.py line 28 21408] 配置详情: {'model': {'type': 'PT-v3m1', 'in_channels': 9, 'num_classes': 2, 'cls_mode': False, 'order': ['z', 'z-trans'], 'pdnorm_bn': False, 'pdnorm_ln': False, 'enc_depths': [2, 2, 6, 2], 'enc_channels': [32, 64, 128, 256], 'enc_num_head': [2, 4, 8, 16], 'stride': [2, 2, 2], 'enc_patch_size': [48, 48, 48, 48], 'dec_depths': [2, 2, 2], 'dec_channels': [64, 64, 128], 'dec_num_head': [4, 4, 8], 'dec_patch_size': [48, 48, 48], 'mlp_ratio': 4, 'qkv_bias': True, 'drop_path': 0.3, 'enable_flash': False}, 'data': {'train': {'type': 'WindShearDataset', 'split': 'train', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'GridSample', 'grid_size': 10.0}, {'type': 'ToTensor'}]}, 'val': {'type': 'WindShearDataset', 'split': 'val', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'GridSample', 'grid_size': 10.0}, {'type': 'ToTensor'}]}, 'test': {'type': 'WindShearDataset', 'split': 'test', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'GridSample', 'grid_size': 10.0}, {'type': 'ToTensor'}]}}, 'train': {'epochs': 100, 'optimizer': {'type': 'AdamW', 'lr': 0.001, 'weight_decay': 0.0001}, 'scheduler': {'type': 'CosineAnnealingLR', 'T_max': 100}, 'batch_size': 2, 'num_workers': 4}, 'evaluation': {'interval': 1}, 'checkpoint': {'interval': 5}, 'log': {'interval': 50}}
[2025-09-19 13:53:42,530 INFO train.py line 32 21408] 使用设备: cuda
[2025-09-19 13:56:00,517 INFO train.py line 27 21841] 使用配置文件: configs/wind_shear/pointtransformer_v3.yaml
[2025-09-19 13:56:00,517 INFO train.py line 28 21841] 配置详情: {'model': {'type': 'PT-v3m1', 'in_channels': 9, 'num_classes': 2, 'cls_mode': False, 'order': ['z', 'z-trans'], 'pdnorm_bn': False, 'pdnorm_ln': False, 'enc_depths': [2, 2, 6, 2], 'enc_channels': [32, 64, 128, 256], 'enc_num_head': [2, 4, 8, 16], 'stride': [2, 2, 2], 'enc_patch_size': [48, 48, 48, 48], 'dec_depths': [2, 2, 2], 'dec_channels': [64, 64, 128], 'dec_num_head': [4, 4, 8], 'dec_patch_size': [48, 48, 48], 'mlp_ratio': 4, 'qkv_bias': True, 'drop_path': 0.3, 'enable_flash': False}, 'data': {'train': {'type': 'WindShearDataset', 'split': 'train', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'GridSample', 'grid_size': 10.0}, {'type': 'ToTensor'}]}, 'val': {'type': 'WindShearDataset', 'split': 'val', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'GridSample', 'grid_size': 10.0}, {'type': 'ToTensor'}]}, 'test': {'type': 'WindShearDataset', 'split': 'test', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'GridSample', 'grid_size': 10.0}, {'type': 'ToTensor'}]}}, 'train': {'epochs': 100, 'optimizer': {'type': 'AdamW', 'lr': 0.001, 'weight_decay': 0.0001}, 'scheduler': {'type': 'CosineAnnealingLR', 'T_max': 100}, 'batch_size': 2, 'num_workers': 4}, 'evaluation': {'interval': 1}, 'checkpoint': {'interval': 5}, 'log': {'interval': 50}}
[2025-09-19 13:56:00,699 INFO train.py line 32 21841] 使用设备: cuda
[2025-09-19 13:56:02,029 INFO train.py line 44 21841] First batch structure (验证collate_fn输出):
[2025-09-19 13:56:02,029 INFO train.py line 47 21841]   offset: shape torch.Size([3]), dtype torch.int64
[2025-09-19 13:56:02,029 INFO train.py line 47 21841]   coord: shape torch.Size([8975, 3]), dtype torch.float32
[2025-09-19 13:56:02,029 INFO train.py line 47 21841]   feat: shape torch.Size([8975, 9]), dtype torch.float32
[2025-09-19 13:56:02,030 INFO train.py line 47 21841]   label: shape torch.Size([8975]), dtype torch.int64
[2025-09-19 13:56:02,030 INFO train.py line 49 21841]   path: type <class 'list'>
[2025-09-19 13:56:02,030 INFO train.py line 47 21841]   beamaz: shape torch.Size([8975]), dtype torch.float32
[2025-09-19 13:56:02,030 INFO train.py line 53 21841] 训练集样本数: 8935, 验证集样本数: 2130
[2025-09-19 13:56:02,323 INFO train.py line 59 21841] 模型类型: PointTransformerV3
[2025-09-19 13:56:02,324 INFO train.py line 83 21841] 
===== Epoch 1/100 =====
[2025-09-19 14:01:26,602 INFO train.py line 27 22852] 使用配置文件: configs/wind_shear/pointtransformer_v3.yaml
[2025-09-19 14:01:26,602 INFO train.py line 28 22852] 配置详情: {'model': {'type': 'PT-v3m1', 'in_channels': 9, 'num_classes': 2, 'cls_mode': False, 'order': ['z', 'z-trans'], 'pdnorm_bn': False, 'pdnorm_ln': False, 'enc_depths': [2, 2, 6, 2], 'enc_channels': [32, 64, 128, 256], 'enc_num_head': [2, 4, 8, 16], 'stride': [2, 2, 2], 'enc_patch_size': [48, 48, 48, 48], 'dec_depths': [2, 2, 2], 'dec_channels': [64, 64, 128], 'dec_num_head': [4, 4, 8], 'dec_patch_size': [48, 48, 48], 'mlp_ratio': 4, 'qkv_bias': True, 'drop_path': 0.3, 'enable_flash': False}, 'data': {'train': {'type': 'WindShearDataset', 'split': 'train', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'GridSample', 'grid_size': 10.0}, {'type': 'ToTensor'}]}, 'val': {'type': 'WindShearDataset', 'split': 'val', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'GridSample', 'grid_size': 10.0}, {'type': 'ToTensor'}]}, 'test': {'type': 'WindShearDataset', 'split': 'test', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'GridSample', 'grid_size': 10.0}, {'type': 'ToTensor'}]}}, 'train': {'epochs': 100, 'optimizer': {'type': 'AdamW', 'lr': 0.001, 'weight_decay': 0.0001}, 'scheduler': {'type': 'CosineAnnealingLR', 'T_max': 100}, 'batch_size': 2, 'num_workers': 4}, 'evaluation': {'interval': 1}, 'checkpoint': {'interval': 5}, 'log': {'interval': 50}}
[2025-09-19 14:01:26,771 INFO train.py line 32 22852] 使用设备: cuda
[2025-09-19 14:01:25,894 INFO train.py line 44 22852] First batch structure (验证collate_fn输出):
[2025-09-19 14:01:25,895 INFO train.py line 47 22852]   offset: shape torch.Size([3]), dtype torch.int64
[2025-09-19 14:01:25,895 INFO train.py line 47 22852]   coord: shape torch.Size([9153, 3]), dtype torch.float32
[2025-09-19 14:01:25,895 INFO train.py line 47 22852]   feat: shape torch.Size([9153, 9]), dtype torch.float32
[2025-09-19 14:01:25,895 INFO train.py line 47 22852]   label: shape torch.Size([9153]), dtype torch.int64
[2025-09-19 14:01:25,895 INFO train.py line 49 22852]   path: type <class 'list'>
[2025-09-19 14:01:25,895 INFO train.py line 47 22852]   beamaz: shape torch.Size([9153]), dtype torch.float32
[2025-09-19 14:01:25,895 INFO train.py line 53 22852] 训练集样本数: 8935, 验证集样本数: 2130
[2025-09-19 14:01:26,136 INFO train.py line 59 22852] 模型类型: PointTransformerV3
[2025-09-19 14:01:26,137 INFO train.py line 83 22852] 
===== Epoch 1/100 =====
[2025-09-19 14:10:41,398 INFO train.py line 27 24528] 使用配置文件: configs/wind_shear/pointtransformer_v3.yaml
[2025-09-19 14:10:41,399 INFO train.py line 28 24528] 配置详情: {'model': {'type': 'PT-v3m1', 'in_channels': 9, 'num_classes': 2, 'cls_mode': False, 'order': ['z', 'z-trans'], 'pdnorm_bn': False, 'pdnorm_ln': False, 'enc_depths': [2, 2, 6, 2], 'enc_channels': [32, 64, 128, 256], 'enc_num_head': [2, 4, 8, 16], 'stride': [2, 2, 2], 'enc_patch_size': [48, 48, 48, 48], 'dec_depths': [2, 2, 2], 'dec_channels': [64, 64, 128], 'dec_num_head': [4, 4, 8], 'dec_patch_size': [48, 48, 48], 'mlp_ratio': 4, 'qkv_bias': True, 'drop_path': 0.3, 'enable_flash': False}, 'data': {'train': {'type': 'WindShearDataset', 'split': 'train', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 10.0}, {'type': 'ToTensor'}]}, 'val': {'type': 'WindShearDataset', 'split': 'val', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 10.0}, {'type': 'ToTensor'}]}, 'test': {'type': 'WindShearDataset', 'split': 'test', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 10.0}, {'type': 'ToTensor'}]}}, 'train': {'epochs': 100, 'optimizer': {'type': 'AdamW', 'lr': 0.001, 'weight_decay': 0.0001}, 'scheduler': {'type': 'CosineAnnealingLR', 'T_max': 100}, 'batch_size': 2, 'num_workers': 4}, 'evaluation': {'interval': 1}, 'checkpoint': {'interval': 5}, 'log': {'interval': 50}}
[2025-09-19 14:10:41,590 INFO train.py line 32 24528] 使用设备: cuda
[2025-09-19 14:10:42,980 INFO train.py line 44 24528] First batch structure (验证collate_fn输出):
[2025-09-19 14:10:42,981 INFO train.py line 47 24528]   offset: shape torch.Size([3]), dtype torch.int64
[2025-09-19 14:10:42,981 INFO train.py line 47 24528]   coord: shape torch.Size([9796, 3]), dtype torch.float32
[2025-09-19 14:10:42,981 INFO train.py line 47 24528]   feat: shape torch.Size([9796, 9]), dtype torch.float32
[2025-09-19 14:10:42,981 INFO train.py line 47 24528]   label: shape torch.Size([9796]), dtype torch.int64
[2025-09-19 14:10:42,981 INFO train.py line 49 24528]   path: type <class 'list'>
[2025-09-19 14:10:42,981 INFO train.py line 47 24528]   beamaz: shape torch.Size([9796]), dtype torch.float32
[2025-09-19 14:10:42,981 INFO train.py line 49 24528]   grid_size: type <class 'list'>
[2025-09-19 14:10:42,981 INFO train.py line 53 24528] 训练集样本数: 8935, 验证集样本数: 2130
[2025-09-19 14:10:43,260 INFO train.py line 59 24528] 模型类型: PointTransformerV3
[2025-09-19 14:10:43,262 INFO train.py line 83 24528] 
===== Epoch 1/100 =====
[2025-09-19 14:14:01,856 INFO train.py line 27 25195] 使用配置文件: configs/wind_shear/pointtransformer_v3.yaml
[2025-09-19 14:14:01,856 INFO train.py line 28 25195] 配置详情: {'model': {'type': 'PT-v3m1', 'in_channels': 9, 'num_classes': 2, 'cls_mode': False, 'order': ['z', 'z-trans'], 'pdnorm_bn': False, 'pdnorm_ln': False, 'enc_depths': [2, 2, 6, 2], 'enc_channels': [32, 64, 128, 256], 'enc_num_head': [2, 4, 8, 16], 'stride': [2, 2, 2], 'enc_patch_size': [48, 48, 48, 48], 'dec_depths': [2, 2, 2], 'dec_channels': [64, 64, 128], 'dec_num_head': [4, 4, 8], 'dec_patch_size': [48, 48, 48], 'mlp_ratio': 4, 'qkv_bias': True, 'drop_path': 0.3, 'enable_flash': False}, 'data': {'train': {'type': 'WindShearDataset', 'split': 'train', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 10.0}, {'type': 'ToTensor'}]}, 'val': {'type': 'WindShearDataset', 'split': 'val', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 10.0}, {'type': 'ToTensor'}]}, 'test': {'type': 'WindShearDataset', 'split': 'test', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 10.0}, {'type': 'ToTensor'}]}}, 'train': {'epochs': 100, 'optimizer': {'type': 'AdamW', 'lr': 0.001, 'weight_decay': 0.0001}, 'scheduler': {'type': 'CosineAnnealingLR', 'T_max': 100}, 'batch_size': 2, 'num_workers': 4}, 'evaluation': {'interval': 1}, 'checkpoint': {'interval': 5}, 'log': {'interval': 50}}
[2025-09-19 14:14:02,054 INFO train.py line 32 25195] 使用设备: cuda
[2025-09-19 14:14:03,153 INFO train.py line 44 25195] First batch structure (验证collate_fn输出):
[2025-09-19 14:14:03,154 INFO train.py line 47 25195]   offset: shape torch.Size([3]), dtype torch.int64
[2025-09-19 14:14:03,154 INFO train.py line 47 25195]   coord: shape torch.Size([9036, 3]), dtype torch.float32
[2025-09-19 14:14:03,154 INFO train.py line 47 25195]   feat: shape torch.Size([9036, 9]), dtype torch.float32
[2025-09-19 14:14:03,154 INFO train.py line 47 25195]   label: shape torch.Size([9036]), dtype torch.int64
[2025-09-19 14:14:03,154 INFO train.py line 49 25195]   path: type <class 'list'>
[2025-09-19 14:14:03,154 INFO train.py line 47 25195]   beamaz: shape torch.Size([9036]), dtype torch.float32
[2025-09-19 14:14:03,154 INFO train.py line 49 25195]   grid_size: type <class 'list'>
[2025-09-19 14:14:03,154 INFO train.py line 53 25195] 训练集样本数: 8935, 验证集样本数: 2130
[2025-09-19 14:14:03,417 INFO train.py line 59 25195] 模型类型: PointTransformerV3
[2025-09-19 14:14:03,420 INFO train.py line 83 25195] 
===== Epoch 1/100 =====
[2025-09-19 14:20:22,446 INFO train.py line 27 26384] 使用配置文件: configs/wind_shear/pointtransformer_v3.yaml
[2025-09-19 14:20:22,447 INFO train.py line 28 26384] 配置详情: {'model': {'type': 'PT-v3m1', 'in_channels': 9, 'num_classes': 2, 'cls_mode': False, 'order': ['z', 'z-trans'], 'pdnorm_bn': False, 'pdnorm_ln': False, 'enc_depths': [2, 2, 6, 2], 'enc_channels': [32, 64, 128, 256], 'enc_num_head': [2, 4, 8, 16], 'stride': [2, 2, 2], 'enc_patch_size': [48, 48, 48, 48], 'dec_depths': [2, 2, 2], 'dec_channels': [64, 64, 128], 'dec_num_head': [4, 4, 8], 'dec_patch_size': [48, 48, 48], 'mlp_ratio': 4, 'qkv_bias': True, 'drop_path': 0.3, 'enable_flash': False}, 'data': {'train': {'type': 'WindShearDataset', 'split': 'train', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 10.0}, {'type': 'ToTensor'}]}, 'val': {'type': 'WindShearDataset', 'split': 'val', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 10.0}, {'type': 'ToTensor'}]}, 'test': {'type': 'WindShearDataset', 'split': 'test', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 10.0}, {'type': 'ToTensor'}]}}, 'train': {'epochs': 100, 'optimizer': {'type': 'AdamW', 'lr': 0.001, 'weight_decay': 0.0001}, 'scheduler': {'type': 'CosineAnnealingLR', 'T_max': 100}, 'batch_size': 2, 'num_workers': 4}, 'evaluation': {'interval': 1}, 'checkpoint': {'interval': 5}, 'log': {'interval': 50}}
[2025-09-19 14:20:22,703 INFO train.py line 32 26384] 使用设备: cuda
[2025-09-19 14:20:23,945 INFO train.py line 44 26384] First batch structure (验证collate_fn输出):
[2025-09-19 14:20:23,946 INFO train.py line 47 26384]   offset: shape torch.Size([3]), dtype torch.int64
[2025-09-19 14:20:23,946 INFO train.py line 47 26384]   coord: shape torch.Size([10079, 3]), dtype torch.float32
[2025-09-19 14:20:23,946 INFO train.py line 47 26384]   feat: shape torch.Size([10079, 9]), dtype torch.float32
[2025-09-19 14:20:23,946 INFO train.py line 47 26384]   label: shape torch.Size([10079]), dtype torch.int64
[2025-09-19 14:20:23,946 INFO train.py line 49 26384]   path: type <class 'list'>
[2025-09-19 14:20:23,946 INFO train.py line 47 26384]   beamaz: shape torch.Size([10079]), dtype torch.float32
[2025-09-19 14:20:23,946 INFO train.py line 47 26384]   grid_size: shape torch.Size([]), dtype torch.float32
[2025-09-19 14:20:23,946 INFO train.py line 53 26384] 训练集样本数: 8935, 验证集样本数: 2130
[2025-09-19 14:20:24,209 INFO train.py line 59 26384] 模型类型: PointTransformerV3
[2025-09-19 14:20:24,211 INFO train.py line 83 26384] 
===== Epoch 1/100 =====
[2025-09-19 14:26:15,848 INFO train.py line 27 27462] 使用配置文件: configs/wind_shear/pointtransformer_v3.yaml
[2025-09-19 14:26:15,848 INFO train.py line 28 27462] 配置详情: {'model': {'type': 'PT-v3m1', 'in_channels': 9, 'num_classes': 2, 'cls_mode': False, 'order': ['z', 'z-trans'], 'pdnorm_bn': False, 'pdnorm_ln': False, 'enc_depths': [2, 2, 6, 2], 'enc_channels': [32, 64, 128, 256], 'enc_num_head': [2, 4, 8, 16], 'stride': [2, 2, 2], 'enc_patch_size': [48, 48, 48, 48], 'dec_depths': [2, 2, 2], 'dec_channels': [64, 64, 128], 'dec_num_head': [4, 4, 8], 'dec_patch_size': [48, 48, 48], 'mlp_ratio': 4, 'qkv_bias': True, 'drop_path': 0.3, 'enable_flash': False}, 'data': {'train': {'type': 'WindShearDataset', 'split': 'train', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 20.0}, {'type': 'ToTensor'}]}, 'val': {'type': 'WindShearDataset', 'split': 'val', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 20.0}, {'type': 'ToTensor'}]}, 'test': {'type': 'WindShearDataset', 'split': 'test', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 20.0}, {'type': 'ToTensor'}]}}, 'train': {'epochs': 100, 'optimizer': {'type': 'AdamW', 'lr': 0.001, 'weight_decay': 0.0001}, 'scheduler': {'type': 'CosineAnnealingLR', 'T_max': 100}, 'batch_size': 2, 'num_workers': 4}, 'evaluation': {'interval': 1}, 'checkpoint': {'interval': 5}, 'log': {'interval': 50}}
[2025-09-19 14:26:16,162 INFO train.py line 32 27462] 使用设备: cuda
[2025-09-19 14:26:15,183 INFO train.py line 44 27462] First batch structure (验证collate_fn输出):
[2025-09-19 14:26:15,183 INFO train.py line 47 27462]   offset: shape torch.Size([3]), dtype torch.int64
[2025-09-19 14:26:15,183 INFO train.py line 47 27462]   coord: shape torch.Size([9443, 3]), dtype torch.float32
[2025-09-19 14:26:15,183 INFO train.py line 47 27462]   feat: shape torch.Size([9443, 9]), dtype torch.float32
[2025-09-19 14:26:15,184 INFO train.py line 47 27462]   label: shape torch.Size([9443]), dtype torch.int64
[2025-09-19 14:26:15,184 INFO train.py line 49 27462]   path: type <class 'list'>
[2025-09-19 14:26:15,184 INFO train.py line 47 27462]   beamaz: shape torch.Size([9452]), dtype torch.float32
[2025-09-19 14:26:15,184 INFO train.py line 47 27462]   grid_size: shape torch.Size([]), dtype torch.float32
[2025-09-19 14:26:15,184 INFO train.py line 53 27462] 训练集样本数: 8935, 验证集样本数: 2130
[2025-09-19 14:26:15,488 INFO train.py line 59 27462] 模型类型: PointTransformerV3
[2025-09-19 14:26:15,489 INFO train.py line 83 27462] 
===== Epoch 1/100 =====
[2025-09-19 15:01:41,058 INFO train.py line 27 33987] 使用配置文件: configs/wind_shear/pointtransformer_v3.yaml
[2025-09-19 15:01:41,058 INFO train.py line 28 33987] 配置详情: {'model': {'type': 'PT-v3m1', 'in_channels': 9, 'num_classes': 2, 'cls_mode': False, 'order': ['z', 'z-trans'], 'pdnorm_bn': False, 'pdnorm_ln': False, 'enc_depths': [2, 2, 6, 2], 'enc_channels': [32, 64, 128, 256], 'enc_num_head': [2, 4, 8, 16], 'stride': [2, 2, 2], 'enc_patch_size': [48, 48, 48, 48], 'dec_depths': [2, 2, 2], 'dec_channels': [64, 64, 128], 'dec_num_head': [4, 4, 8], 'dec_patch_size': [48, 48, 48], 'mlp_ratio': 4, 'qkv_bias': True, 'drop_path': 0.3, 'enable_flash': False}, 'data': {'train': {'type': 'WindShearDataset', 'split': 'train', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 10.0}, {'type': 'ToTensor'}]}, 'val': {'type': 'WindShearDataset', 'split': 'val', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 10.0}, {'type': 'ToTensor'}]}, 'test': {'type': 'WindShearDataset', 'split': 'test', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 10.0}, {'type': 'ToTensor'}]}}, 'train': {'epochs': 100, 'optimizer': {'type': 'AdamW', 'lr': 0.001, 'weight_decay': 0.0001}, 'scheduler': {'type': 'CosineAnnealingLR', 'T_max': 100}, 'batch_size': 2, 'num_workers': 4}, 'evaluation': {'interval': 1}, 'checkpoint': {'interval': 5}, 'log': {'interval': 50}}
[2025-09-19 15:01:41,264 INFO train.py line 32 33987] 使用设备: cuda
[2025-09-19 15:01:42,526 INFO train.py line 44 33987] First batch structure (验证collate_fn输出):
[2025-09-19 15:01:42,526 INFO train.py line 47 33987]   offset: shape torch.Size([3]), dtype torch.int64
[2025-09-19 15:01:42,526 INFO train.py line 47 33987]   coord: shape torch.Size([8739, 3]), dtype torch.float32
[2025-09-19 15:01:42,526 INFO train.py line 47 33987]   feat: shape torch.Size([8739, 9]), dtype torch.float32
[2025-09-19 15:01:42,526 INFO train.py line 47 33987]   label: shape torch.Size([8739]), dtype torch.int64
[2025-09-19 15:01:42,526 INFO train.py line 49 33987]   path: type <class 'list'>
[2025-09-19 15:01:42,526 INFO train.py line 47 33987]   beamaz: shape torch.Size([8739]), dtype torch.float32
[2025-09-19 15:01:42,526 INFO train.py line 47 33987]   grid_size: shape torch.Size([]), dtype torch.float32
[2025-09-19 15:01:42,526 INFO train.py line 53 33987] 训练集样本数: 8935, 验证集样本数: 2130
[2025-09-19 15:01:42,850 INFO train.py line 59 33987] 模型类型: PointTransformerV3
[2025-09-19 15:01:42,851 INFO train.py line 83 33987] 
===== Epoch 1/100 =====
[2025-09-19 15:04:20,262 INFO train.py line 27 34550] 使用配置文件: configs/wind_shear/pointtransformer_v3.yaml
[2025-09-19 15:04:20,262 INFO train.py line 28 34550] 配置详情: {'model': {'type': 'PT-v3m1', 'in_channels': 9, 'num_classes': 2, 'cls_mode': False, 'order': ['z', 'z-trans'], 'pdnorm_bn': False, 'pdnorm_ln': False, 'enc_depths': [2, 2, 6, 2], 'enc_channels': [32, 64, 128, 256], 'enc_num_head': [2, 4, 8, 16], 'stride': [2, 2, 2], 'enc_patch_size': [48, 48, 48, 48], 'dec_depths': [2, 2, 2], 'dec_channels': [64, 64, 128], 'dec_num_head': [4, 4, 8], 'dec_patch_size': [48, 48, 48], 'mlp_ratio': 4, 'qkv_bias': True, 'drop_path': 0.3, 'enable_flash': False}, 'data': {'train': {'type': 'WindShearDataset', 'split': 'train', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 3.0}, {'type': 'ToTensor'}]}, 'val': {'type': 'WindShearDataset', 'split': 'val', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 3.0}, {'type': 'ToTensor'}]}, 'test': {'type': 'WindShearDataset', 'split': 'test', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 3.0}, {'type': 'ToTensor'}]}}, 'train': {'epochs': 100, 'optimizer': {'type': 'AdamW', 'lr': 0.001, 'weight_decay': 0.0001}, 'scheduler': {'type': 'CosineAnnealingLR', 'T_max': 100}, 'batch_size': 2, 'num_workers': 4}, 'evaluation': {'interval': 1}, 'checkpoint': {'interval': 5}, 'log': {'interval': 50}}
[2025-09-19 15:04:20,464 INFO train.py line 32 34550] 使用设备: cuda
[2025-09-19 15:04:21,627 INFO train.py line 44 34550] First batch structure (验证collate_fn输出):
[2025-09-19 15:04:21,627 INFO train.py line 47 34550]   offset: shape torch.Size([3]), dtype torch.int64
[2025-09-19 15:04:21,627 INFO train.py line 47 34550]   coord: shape torch.Size([9838, 3]), dtype torch.float32
[2025-09-19 15:04:21,627 INFO train.py line 47 34550]   feat: shape torch.Size([9838, 9]), dtype torch.float32
[2025-09-19 15:04:21,627 INFO train.py line 47 34550]   label: shape torch.Size([9838]), dtype torch.int64
[2025-09-19 15:04:21,627 INFO train.py line 49 34550]   path: type <class 'list'>
[2025-09-19 15:04:21,627 INFO train.py line 47 34550]   beamaz: shape torch.Size([9838]), dtype torch.float32
[2025-09-19 15:04:21,627 INFO train.py line 47 34550]   grid_size: shape torch.Size([]), dtype torch.float32
[2025-09-19 15:04:21,627 INFO train.py line 53 34550] 训练集样本数: 8935, 验证集样本数: 2130
[2025-09-19 15:04:21,863 INFO train.py line 59 34550] 模型类型: PointTransformerV3
[2025-09-19 15:04:21,865 INFO train.py line 83 34550] 
===== Epoch 1/100 =====
[2025-09-19 17:05:21,097 INFO train.py line 27 54867] 使用配置文件: configs/wind_shear/pointtransformer_v3.yaml
[2025-09-19 17:05:21,097 INFO train.py line 28 54867] 配置详情: {'model': {'type': 'PT-v3m1', 'in_channels': 9, 'num_classes': 2, 'cls_mode': False, 'order': ['z', 'z-trans'], 'pdnorm_bn': False, 'pdnorm_ln': False, 'enc_depths': [2, 2, 6, 2], 'enc_channels': [32, 64, 128, 256], 'enc_num_head': [2, 4, 8, 16], 'stride': [2, 2, 2], 'enc_patch_size': [48, 48, 48, 48], 'dec_depths': [2, 2, 2], 'dec_channels': [64, 64, 128], 'dec_num_head': [4, 4, 8], 'dec_patch_size': [48, 48, 48], 'mlp_ratio': 4, 'qkv_bias': True, 'drop_path': 0.3, 'enable_flash': False}, 'data': {'train': {'type': 'WindShearDataset', 'split': 'train', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 50.0}, {'type': 'ToTensor'}]}, 'val': {'type': 'WindShearDataset', 'split': 'val', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 50.0}, {'type': 'ToTensor'}]}, 'test': {'type': 'WindShearDataset', 'split': 'test', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 50.0}, {'type': 'ToTensor'}]}}, 'train': {'epochs': 100, 'optimizer': {'type': 'AdamW', 'lr': 0.001, 'weight_decay': 0.0001}, 'scheduler': {'type': 'CosineAnnealingLR', 'T_max': 100}, 'batch_size': 2, 'num_workers': 4}, 'evaluation': {'interval': 1}, 'checkpoint': {'interval': 5}, 'log': {'interval': 50}}
[2025-09-19 17:05:21,599 INFO train.py line 32 54867] 使用设备: cuda
[2025-09-19 17:05:23,457 INFO train.py line 44 54867] First batch structure (验证collate_fn输出):
[2025-09-19 17:05:23,458 INFO train.py line 47 54867]   offset: shape torch.Size([3]), dtype torch.int64
[2025-09-19 17:05:23,458 INFO train.py line 47 54867]   coord: shape torch.Size([9851, 3]), dtype torch.float32
[2025-09-19 17:05:23,458 INFO train.py line 47 54867]   feat: shape torch.Size([9851, 9]), dtype torch.float32
[2025-09-19 17:05:23,458 INFO train.py line 47 54867]   label: shape torch.Size([9851]), dtype torch.int64
[2025-09-19 17:05:23,458 INFO train.py line 49 54867]   path: type <class 'list'>
[2025-09-19 17:05:23,458 INFO train.py line 47 54867]   beamaz: shape torch.Size([10102]), dtype torch.float32
[2025-09-19 17:05:23,458 INFO train.py line 47 54867]   grid_size: shape torch.Size([]), dtype torch.float32
[2025-09-19 17:05:23,458 INFO train.py line 53 54867] 训练集样本数: 8935, 验证集样本数: 2130
[2025-09-19 17:05:23,817 INFO train.py line 59 54867] 模型类型: PointTransformerV3
[2025-09-19 17:05:23,819 INFO train.py line 83 54867] 
===== Epoch 1/100 =====
[2025-09-19 17:16:20,656 INFO train.py line 27 56917] 使用配置文件: configs/wind_shear/pointtransformer_v3.yaml
[2025-09-19 17:16:20,657 INFO train.py line 28 56917] 配置详情: {'model': {'type': 'PT-v3m1', 'in_channels': 9, 'num_classes': 2, 'cls_mode': False, 'order': ['z', 'z-trans'], 'pdnorm_bn': False, 'pdnorm_ln': False, 'enc_depths': [2, 2, 6, 2], 'enc_channels': [32, 64, 128, 256], 'enc_num_head': [2, 4, 8, 16], 'stride': [2, 2, 2], 'enc_patch_size': [48, 48, 48, 48], 'dec_depths': [2, 2, 2], 'dec_channels': [64, 64, 128], 'dec_num_head': [4, 4, 8], 'dec_patch_size': [48, 48, 48], 'mlp_ratio': 4, 'qkv_bias': True, 'drop_path': 0.3, 'enable_flash': False}, 'data': {'train': {'type': 'WindShearDataset', 'split': 'train', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 80.0}, {'type': 'ToTensor'}]}, 'val': {'type': 'WindShearDataset', 'split': 'val', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 80.0}, {'type': 'ToTensor'}]}, 'test': {'type': 'WindShearDataset', 'split': 'test', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 80.0}, {'type': 'ToTensor'}]}}, 'train': {'epochs': 100, 'optimizer': {'type': 'AdamW', 'lr': 0.001, 'weight_decay': 0.0001}, 'scheduler': {'type': 'CosineAnnealingLR', 'T_max': 100}, 'batch_size': 2, 'num_workers': 4}, 'evaluation': {'interval': 1}, 'checkpoint': {'interval': 5}, 'log': {'interval': 50}}
[2025-09-19 17:16:20,834 INFO train.py line 32 56917] 使用设备: cuda
[2025-09-19 17:16:22,123 INFO train.py line 44 56917] First batch structure (验证collate_fn输出):
[2025-09-19 17:16:22,123 INFO train.py line 47 56917]   offset: shape torch.Size([3]), dtype torch.int64
[2025-09-19 17:16:22,123 INFO train.py line 47 56917]   coord: shape torch.Size([10205, 3]), dtype torch.float32
[2025-09-19 17:16:22,123 INFO train.py line 47 56917]   feat: shape torch.Size([10205, 9]), dtype torch.float32
[2025-09-19 17:16:22,123 INFO train.py line 47 56917]   label: shape torch.Size([10205]), dtype torch.int64
[2025-09-19 17:16:22,123 INFO train.py line 49 56917]   path: type <class 'list'>
[2025-09-19 17:16:22,123 INFO train.py line 47 56917]   beamaz: shape torch.Size([10745]), dtype torch.float32
[2025-09-19 17:16:22,123 INFO train.py line 47 56917]   grid_size: shape torch.Size([]), dtype torch.float32
[2025-09-19 17:16:22,123 INFO train.py line 53 56917] 训练集样本数: 8935, 验证集样本数: 2130
[2025-09-19 17:16:22,451 INFO train.py line 59 56917] 模型类型: PointTransformerV3
[2025-09-19 17:16:22,452 INFO train.py line 83 56917] 
===== Epoch 1/100 =====
[2025-09-19 17:23:21,074 INFO train.py line 27 58256] 使用配置文件: configs/wind_shear/pointtransformer_v3.yaml
[2025-09-19 17:23:21,074 INFO train.py line 28 58256] 配置详情: {'model': {'type': 'PT-v3m1', 'in_channels': 9, 'num_classes': 2, 'cls_mode': False, 'order': ['z', 'z-trans'], 'pdnorm_bn': False, 'pdnorm_ln': False, 'enc_depths': [2, 2, 6, 2], 'enc_channels': [32, 64, 128, 256], 'enc_num_head': [2, 4, 8, 16], 'stride': [2, 2, 2], 'enc_patch_size': [48, 48, 48, 48], 'dec_depths': [2, 2, 2], 'dec_channels': [64, 64, 128], 'dec_num_head': [4, 4, 8], 'dec_patch_size': [48, 48, 48], 'mlp_ratio': 4, 'qkv_bias': True, 'drop_path': 0.3, 'enable_flash': False}, 'data': {'train': {'type': 'WindShearDataset', 'split': 'train', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 80.0, 'min_points': 50, 'adaptive': True}, {'type': 'ToTensor'}]}, 'val': {'type': 'WindShearDataset', 'split': 'val', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 80.0, 'min_points': 50, 'adaptive': True}, {'type': 'ToTensor'}]}, 'test': {'type': 'WindShearDataset', 'split': 'test', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 80.0, 'min_points': 50, 'adaptive': True}, {'type': 'ToTensor'}]}}, 'train': {'epochs': 100, 'optimizer': {'type': 'AdamW', 'lr': 0.001, 'weight_decay': 0.0001}, 'scheduler': {'type': 'CosineAnnealingLR', 'T_max': 100}, 'batch_size': 2, 'num_workers': 4}, 'evaluation': {'interval': 1}, 'checkpoint': {'interval': 5}, 'log': {'interval': 50}}
[2025-09-19 17:23:21,316 INFO train.py line 32 58256] 使用设备: cuda
[2025-09-19 17:23:22,551 INFO train.py line 44 58256] First batch structure (验证collate_fn输出):
[2025-09-19 17:23:22,552 INFO train.py line 47 58256]   offset: shape torch.Size([3]), dtype torch.int64
[2025-09-19 17:23:22,552 INFO train.py line 47 58256]   coord: shape torch.Size([5643, 3]), dtype torch.float32
[2025-09-19 17:23:22,552 INFO train.py line 47 58256]   feat: shape torch.Size([5643, 9]), dtype torch.float32
[2025-09-19 17:23:22,552 INFO train.py line 47 58256]   label: shape torch.Size([5643]), dtype torch.int64
[2025-09-19 17:23:22,552 INFO train.py line 49 58256]   path: type <class 'list'>
[2025-09-19 17:23:22,552 INFO train.py line 47 58256]   beamaz: shape torch.Size([9268]), dtype torch.float32
[2025-09-19 17:23:22,552 INFO train.py line 47 58256]   grid_size: shape torch.Size([]), dtype torch.float32
[2025-09-19 17:23:22,552 INFO train.py line 53 58256] 训练集样本数: 8935, 验证集样本数: 2130
[2025-09-19 17:23:22,849 INFO train.py line 59 58256] 模型类型: PointTransformerV3
[2025-09-19 17:23:22,850 INFO train.py line 83 58256] 
===== Epoch 1/100 =====
[2025-09-19 17:34:26,528 INFO train.py line 27 60257] 使用配置文件: configs/wind_shear/pointtransformer_v3.yaml
[2025-09-19 17:34:26,528 INFO train.py line 28 60257] 配置详情: {'model': {'type': 'PT-v3m1', 'in_channels': 9, 'num_classes': 2, 'cls_mode': False, 'order': ['z', 'z-trans'], 'pdnorm_bn': False, 'pdnorm_ln': False, 'enc_depths': [2, 2, 6, 2], 'enc_channels': [32, 64, 128, 256], 'enc_num_head': [2, 4, 8, 16], 'stride': [2, 2, 2], 'enc_patch_size': [48, 48, 48, 48], 'dec_depths': [2, 2, 2], 'dec_channels': [64, 64, 128], 'dec_num_head': [4, 4, 8], 'dec_patch_size': [48, 48, 48], 'mlp_ratio': 4, 'qkv_bias': True, 'drop_path': 0.3, 'enable_flash': False}, 'data': {'train': {'type': 'WindShearDataset', 'split': 'train', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 80.0, 'min_points': 50, 'adaptive': True}, {'type': 'ToTensor'}]}, 'val': {'type': 'WindShearDataset', 'split': 'val', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 80.0, 'min_points': 50, 'adaptive': True}, {'type': 'ToTensor'}]}, 'test': {'type': 'WindShearDataset', 'split': 'test', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 80.0, 'min_points': 50, 'adaptive': True}, {'type': 'ToTensor'}]}}, 'train': {'epochs': 100, 'optimizer': {'type': 'AdamW', 'lr': 0.001, 'weight_decay': 0.0001}, 'scheduler': {'type': 'CosineAnnealingLR', 'T_max': 100}, 'batch_size': 2, 'num_workers': 4}, 'evaluation': {'interval': 1}, 'checkpoint': {'interval': 5}, 'log': {'interval': 50}}
[2025-09-19 17:34:26,760 INFO train.py line 32 60257] 使用设备: cuda
[2025-09-19 17:34:28,064 INFO train.py line 44 60257] First batch structure (验证collate_fn输出):
[2025-09-19 17:34:28,064 INFO train.py line 47 60257]   offset: shape torch.Size([3]), dtype torch.int64
[2025-09-19 17:34:28,064 INFO train.py line 47 60257]   coord: shape torch.Size([6583, 3]), dtype torch.float32
[2025-09-19 17:34:28,064 INFO train.py line 47 60257]   feat: shape torch.Size([6583, 9]), dtype torch.float32
[2025-09-19 17:34:28,065 INFO train.py line 47 60257]   label: shape torch.Size([6583]), dtype torch.int64
[2025-09-19 17:34:28,065 INFO train.py line 49 60257]   path: type <class 'list'>
[2025-09-19 17:34:28,065 INFO train.py line 47 60257]   beamaz: shape torch.Size([9285]), dtype torch.float32
[2025-09-19 17:34:28,065 INFO train.py line 47 60257]   grid_size: shape torch.Size([]), dtype torch.float32
[2025-09-19 17:34:28,065 INFO train.py line 53 60257] 训练集样本数: 8935, 验证集样本数: 2130
[2025-09-19 17:34:28,378 INFO train.py line 59 60257] 模型类型: PointTransformerV3
[2025-09-19 17:34:28,379 INFO train.py line 83 60257] 
===== Epoch 1/100 =====
[2025-09-19 17:41:31,830 INFO train.py line 27 61578] 使用配置文件: configs/wind_shear/pointtransformer_v3.yaml
[2025-09-19 17:41:31,830 INFO train.py line 28 61578] 配置详情: {'model': {'type': 'PT-v3m1', 'in_channels': 9, 'num_classes': 2, 'cls_mode': False, 'order': ['z', 'z-trans'], 'pdnorm_bn': False, 'pdnorm_ln': False, 'enc_depths': [2, 2, 6, 2], 'enc_channels': [32, 64, 128, 256], 'enc_num_head': [2, 4, 8, 16], 'stride': [2, 2, 2], 'enc_patch_size': [48, 48, 48, 48], 'dec_depths': [2, 2, 2], 'dec_channels': [64, 64, 128], 'dec_num_head': [4, 4, 8], 'dec_patch_size': [48, 48, 48], 'mlp_ratio': 4, 'qkv_bias': True, 'drop_path': 0.3, 'enable_flash': False}, 'data': {'train': {'type': 'WindShearDataset', 'split': 'train', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 80.0, 'min_points': 50, 'adaptive': True}, {'type': 'ToTensor'}]}, 'val': {'type': 'WindShearDataset', 'split': 'val', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 80.0, 'min_points': 50, 'adaptive': True}, {'type': 'ToTensor'}]}, 'test': {'type': 'WindShearDataset', 'split': 'test', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 80.0, 'min_points': 50, 'adaptive': True}, {'type': 'ToTensor'}]}}, 'train': {'epochs': 100, 'optimizer': {'type': 'AdamW', 'lr': 0.001, 'weight_decay': 0.0001}, 'scheduler': {'type': 'CosineAnnealingLR', 'T_max': 100}, 'batch_size': 2, 'num_workers': 4}, 'evaluation': {'interval': 1}, 'checkpoint': {'interval': 5}, 'log': {'interval': 50}}
[2025-09-19 17:41:32,017 INFO train.py line 32 61578] 使用设备: cuda
[2025-09-19 17:41:33,343 INFO train.py line 44 61578] First batch structure (验证collate_fn输出):
[2025-09-19 17:41:33,343 INFO train.py line 47 61578]   offset: shape torch.Size([3]), dtype torch.int64
[2025-09-19 17:41:33,343 INFO train.py line 47 61578]   coord: shape torch.Size([6960, 3]), dtype torch.float32
[2025-09-19 17:41:33,343 INFO train.py line 47 61578]   feat: shape torch.Size([6960, 9]), dtype torch.float32
[2025-09-19 17:41:33,343 INFO train.py line 47 61578]   label: shape torch.Size([6960]), dtype torch.int64
[2025-09-19 17:41:33,343 INFO train.py line 49 61578]   path: type <class 'list'>
[2025-09-19 17:41:33,343 INFO train.py line 47 61578]   beamaz: shape torch.Size([10433]), dtype torch.float32
[2025-09-19 17:41:33,343 INFO train.py line 47 61578]   grid_size: shape torch.Size([]), dtype torch.float32
[2025-09-19 17:41:33,343 INFO train.py line 53 61578] 训练集样本数: 8935, 验证集样本数: 2130
[2025-09-19 17:41:33,586 INFO train.py line 59 61578] 模型类型: PointTransformerV3
[2025-09-19 17:41:33,588 INFO train.py line 83 61578] 
===== Epoch 1/100 =====
[2025-09-19 17:44:52,794 INFO train.py line 27 62262] 使用配置文件: configs/wind_shear/pointtransformer_v3.yaml
[2025-09-19 17:44:52,795 INFO train.py line 28 62262] 配置详情: {'model': {'type': 'PT-v3m1', 'in_channels': 9, 'num_classes': 2, 'cls_mode': False, 'order': ['z', 'z-trans'], 'pdnorm_bn': False, 'pdnorm_ln': False, 'enc_depths': [2, 2, 6, 2], 'enc_channels': [32, 64, 128, 256], 'enc_num_head': [2, 4, 8, 16], 'stride': [2, 2, 2], 'enc_patch_size': [48, 48, 48, 48], 'dec_depths': [2, 2, 2], 'dec_channels': [64, 64, 128], 'dec_num_head': [4, 4, 8], 'dec_patch_size': [48, 48, 48], 'mlp_ratio': 4, 'qkv_bias': True, 'drop_path': 0.3, 'enable_flash': False}, 'data': {'train': {'type': 'WindShearDataset', 'split': 'train', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 80.0, 'min_points': 50, 'adaptive': True}, {'type': 'ToTensor'}]}, 'val': {'type': 'WindShearDataset', 'split': 'val', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 80.0, 'min_points': 50, 'adaptive': True}, {'type': 'ToTensor'}]}, 'test': {'type': 'WindShearDataset', 'split': 'test', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 80.0, 'min_points': 50, 'adaptive': True}, {'type': 'ToTensor'}]}}, 'train': {'epochs': 100, 'optimizer': {'type': 'AdamW', 'lr': 0.001, 'weight_decay': 0.0001}, 'scheduler': {'type': 'CosineAnnealingLR', 'T_max': 100}, 'batch_size': 2, 'num_workers': 4}, 'evaluation': {'interval': 1}, 'checkpoint': {'interval': 5}, 'log': {'interval': 50}}
[2025-09-19 17:44:52,997 INFO train.py line 32 62262] 使用设备: cuda
[2025-09-19 17:44:54,310 INFO train.py line 44 62262] First batch structure (验证collate_fn输出):
[2025-09-19 17:44:54,310 INFO train.py line 47 62262]   offset: shape torch.Size([3]), dtype torch.int64
[2025-09-19 17:44:54,310 INFO train.py line 47 62262]   coord: shape torch.Size([6448, 3]), dtype torch.float32
[2025-09-19 17:44:54,310 INFO train.py line 47 62262]   feat: shape torch.Size([6448, 9]), dtype torch.float32
[2025-09-19 17:44:54,310 INFO train.py line 47 62262]   label: shape torch.Size([6448]), dtype torch.int64
[2025-09-19 17:44:54,310 INFO train.py line 49 62262]   path: type <class 'list'>
[2025-09-19 17:44:54,310 INFO train.py line 47 62262]   beamaz: shape torch.Size([10432]), dtype torch.float32
[2025-09-19 17:44:54,310 INFO train.py line 47 62262]   grid_size: shape torch.Size([]), dtype torch.float32
[2025-09-19 17:44:54,310 INFO train.py line 53 62262] 训练集样本数: 8935, 验证集样本数: 2130
[2025-09-19 17:44:54,613 INFO train.py line 59 62262] 模型类型: PointTransformerV3
[2025-09-19 17:44:54,614 INFO train.py line 83 62262] 
===== Epoch 1/100 =====
[2025-09-19 17:47:20,177 INFO train.py line 27 62775] 使用配置文件: configs/wind_shear/pointtransformer_v3.yaml
[2025-09-19 17:47:20,177 INFO train.py line 28 62775] 配置详情: {'model': {'type': 'PT-v3m1', 'in_channels': 9, 'num_classes': 2, 'cls_mode': False, 'order': ['z', 'z-trans'], 'pdnorm_bn': False, 'pdnorm_ln': False, 'enc_depths': [2, 2, 6, 2], 'enc_channels': [32, 64, 128, 256], 'enc_num_head': [2, 4, 8, 16], 'stride': [2, 2, 2], 'enc_patch_size': [48, 48, 48, 48], 'dec_depths': [2, 2, 2], 'dec_channels': [64, 64, 128], 'dec_num_head': [4, 4, 8], 'dec_patch_size': [48, 48, 48], 'mlp_ratio': 4, 'qkv_bias': True, 'drop_path': 0.3, 'enable_flash': False}, 'data': {'train': {'type': 'WindShearDataset', 'split': 'train', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 80.0, 'min_points': 50, 'adaptive': True}, {'type': 'ToTensor'}]}, 'val': {'type': 'WindShearDataset', 'split': 'val', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 80.0, 'min_points': 50, 'adaptive': True}, {'type': 'ToTensor'}]}, 'test': {'type': 'WindShearDataset', 'split': 'test', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 80.0, 'min_points': 50, 'adaptive': True}, {'type': 'ToTensor'}]}}, 'train': {'epochs': 100, 'optimizer': {'type': 'AdamW', 'lr': 0.001, 'weight_decay': 0.0001}, 'scheduler': {'type': 'CosineAnnealingLR', 'T_max': 100}, 'batch_size': 2, 'num_workers': 4}, 'evaluation': {'interval': 1}, 'checkpoint': {'interval': 5}, 'log': {'interval': 50}}
[2025-09-19 17:47:20,431 INFO train.py line 32 62775] 使用设备: cuda
[2025-09-19 17:47:21,644 INFO train.py line 44 62775] First batch structure (验证collate_fn输出):
[2025-09-19 17:47:21,644 INFO train.py line 47 62775]   offset: shape torch.Size([3]), dtype torch.int64
[2025-09-19 17:47:21,644 INFO train.py line 47 62775]   coord: shape torch.Size([5968, 3]), dtype torch.float32
[2025-09-19 17:47:21,644 INFO train.py line 47 62775]   feat: shape torch.Size([5968, 9]), dtype torch.float32
[2025-09-19 17:47:21,644 INFO train.py line 47 62775]   label: shape torch.Size([5968]), dtype torch.int64
[2025-09-19 17:47:21,644 INFO train.py line 49 62775]   path: type <class 'list'>
[2025-09-19 17:47:21,644 INFO train.py line 47 62775]   beamaz: shape torch.Size([9195]), dtype torch.float32
[2025-09-19 17:47:21,644 INFO train.py line 47 62775]   grid_size: shape torch.Size([]), dtype torch.float32
[2025-09-19 17:47:21,644 INFO train.py line 53 62775] 训练集样本数: 8935, 验证集样本数: 2130
[2025-09-19 17:47:21,978 INFO train.py line 59 62775] 模型类型: PointTransformerV3
[2025-09-19 17:47:21,980 INFO train.py line 83 62775] 
===== Epoch 1/100 =====
[2025-09-19 17:50:06,212 INFO train.py line 27 63369] 使用配置文件: configs/wind_shear/pointtransformer_v3.yaml
[2025-09-19 17:50:06,212 INFO train.py line 28 63369] 配置详情: {'model': {'type': 'PT-v3m1', 'in_channels': 9, 'num_classes': 2, 'cls_mode': False, 'order': ['z', 'z-trans'], 'pdnorm_bn': False, 'pdnorm_ln': False, 'enc_depths': [2, 2, 6, 2], 'enc_channels': [32, 64, 128, 256], 'enc_num_head': [2, 4, 8, 16], 'stride': [2, 2, 2], 'enc_patch_size': [48, 48, 48, 48], 'dec_depths': [2, 2, 2], 'dec_channels': [64, 64, 128], 'dec_num_head': [4, 4, 8], 'dec_patch_size': [48, 48, 48], 'mlp_ratio': 4, 'qkv_bias': True, 'drop_path': 0.3, 'enable_flash': False}, 'data': {'train': {'type': 'WindShearDataset', 'split': 'train', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 80.0, 'min_points': 50, 'adaptive': True}, {'type': 'ToTensor'}]}, 'val': {'type': 'WindShearDataset', 'split': 'val', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 80.0, 'min_points': 50, 'adaptive': True}, {'type': 'ToTensor'}]}, 'test': {'type': 'WindShearDataset', 'split': 'test', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 80.0, 'min_points': 50, 'adaptive': True}, {'type': 'ToTensor'}]}}, 'train': {'epochs': 100, 'optimizer': {'type': 'AdamW', 'lr': 0.001, 'weight_decay': 0.0001}, 'scheduler': {'type': 'CosineAnnealingLR', 'T_max': 100}, 'batch_size': 2, 'num_workers': 4}, 'evaluation': {'interval': 1}, 'checkpoint': {'interval': 5}, 'log': {'interval': 50}}
[2025-09-19 17:50:06,416 INFO train.py line 32 63369] 使用设备: cuda
[2025-09-19 17:50:07,580 INFO train.py line 44 63369] First batch structure (验证collate_fn输出):
[2025-09-19 17:50:07,580 INFO train.py line 47 63369]   offset: shape torch.Size([3]), dtype torch.int64
[2025-09-19 17:50:07,580 INFO train.py line 47 63369]   coord: shape torch.Size([5808, 3]), dtype torch.float32
[2025-09-19 17:50:07,580 INFO train.py line 47 63369]   feat: shape torch.Size([5808, 9]), dtype torch.float32
[2025-09-19 17:50:07,580 INFO train.py line 47 63369]   label: shape torch.Size([5808]), dtype torch.int64
[2025-09-19 17:50:07,580 INFO train.py line 49 63369]   path: type <class 'list'>
[2025-09-19 17:50:07,580 INFO train.py line 47 63369]   beamaz: shape torch.Size([8170]), dtype torch.float32
[2025-09-19 17:50:07,580 INFO train.py line 47 63369]   grid_size: shape torch.Size([]), dtype torch.float32
[2025-09-19 17:50:07,580 INFO train.py line 53 63369] 训练集样本数: 8935, 验证集样本数: 2130
[2025-09-19 17:50:07,890 INFO train.py line 59 63369] 模型类型: PointTransformerV3
[2025-09-19 17:50:07,892 INFO train.py line 83 63369] 
===== Epoch 1/100 =====
[2025-09-19 17:52:40,999 INFO train.py line 27 63890] 使用配置文件: configs/wind_shear/pointtransformer_v3.yaml
[2025-09-19 17:52:40,999 INFO train.py line 28 63890] 配置详情: {'model': {'type': 'PT-v3m1', 'in_channels': 9, 'num_classes': 2, 'cls_mode': False, 'order': ['z', 'z-trans'], 'pdnorm_bn': False, 'pdnorm_ln': False, 'enc_depths': [2, 2, 6, 2], 'enc_channels': [32, 64, 128, 256], 'enc_num_head': [2, 4, 8, 16], 'stride': [2, 2, 2], 'enc_patch_size': [48, 48, 48, 48], 'dec_depths': [2, 2, 2], 'dec_channels': [64, 64, 128], 'dec_num_head': [4, 4, 8], 'dec_patch_size': [48, 48, 48], 'mlp_ratio': 4, 'qkv_bias': True, 'drop_path': 0.3, 'enable_flash': False}, 'data': {'train': {'type': 'WindShearDataset', 'split': 'train', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 80.0, 'min_points': 50, 'adaptive': True}, {'type': 'ToTensor'}]}, 'val': {'type': 'WindShearDataset', 'split': 'val', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 80.0, 'min_points': 50, 'adaptive': True}, {'type': 'ToTensor'}]}, 'test': {'type': 'WindShearDataset', 'split': 'test', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 80.0, 'min_points': 50, 'adaptive': True}, {'type': 'ToTensor'}]}}, 'train': {'epochs': 100, 'optimizer': {'type': 'AdamW', 'lr': 0.001, 'weight_decay': 0.0001}, 'scheduler': {'type': 'CosineAnnealingLR', 'T_max': 100}, 'batch_size': 2, 'num_workers': 4}, 'evaluation': {'interval': 1}, 'checkpoint': {'interval': 5}, 'log': {'interval': 50}}
[2025-09-19 17:52:41,326 INFO train.py line 32 63890] 使用设备: cuda
[2025-09-19 17:52:42,530 INFO train.py line 44 63890] First batch structure (验证collate_fn输出):
[2025-09-19 17:52:42,530 INFO train.py line 47 63890]   offset: shape torch.Size([3]), dtype torch.int64
[2025-09-19 17:52:42,530 INFO train.py line 47 63890]   coord: shape torch.Size([6528, 3]), dtype torch.float32
[2025-09-19 17:52:42,531 INFO train.py line 47 63890]   feat: shape torch.Size([6528, 9]), dtype torch.float32
[2025-09-19 17:52:42,531 INFO train.py line 47 63890]   label: shape torch.Size([6528]), dtype torch.int64
[2025-09-19 17:52:42,531 INFO train.py line 49 63890]   path: type <class 'list'>
[2025-09-19 17:52:42,531 INFO train.py line 47 63890]   beamaz: shape torch.Size([9067]), dtype torch.float32
[2025-09-19 17:52:42,531 INFO train.py line 47 63890]   grid_size: shape torch.Size([]), dtype torch.float32
[2025-09-19 17:52:42,531 INFO train.py line 53 63890] 训练集样本数: 8935, 验证集样本数: 2130
[2025-09-19 17:52:42,789 INFO train.py line 59 63890] 模型类型: PointTransformerV3
[2025-09-19 17:52:42,790 INFO train.py line 83 63890] 
===== Epoch 1/100 =====
[2025-09-19 18:01:45,663 INFO train.py line 27 65538] 使用配置文件: configs/wind_shear/pointtransformer_v3.yaml
[2025-09-19 18:01:45,663 INFO train.py line 28 65538] 配置详情: {'model': {'type': 'PT-v3m1', 'in_channels': 9, 'num_classes': 2, 'cls_mode': False, 'order': ['z', 'z-trans'], 'pdnorm_bn': False, 'pdnorm_ln': False, 'enc_depths': [2, 2, 6, 2], 'enc_channels': [32, 64, 128, 256], 'enc_num_head': [2, 4, 8, 16], 'stride': [2, 2, 2], 'enc_patch_size': [48, 48, 48, 48], 'dec_depths': [2, 2, 2], 'dec_channels': [64, 64, 128], 'dec_num_head': [4, 4, 8], 'dec_patch_size': [48, 48, 48], 'mlp_ratio': 4, 'qkv_bias': True, 'drop_path': 0.3, 'enable_flash': False}, 'data': {'train': {'type': 'WindShearDataset', 'split': 'train', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 80.0, 'min_points': 50, 'adaptive': True}, {'type': 'ToTensor'}]}, 'val': {'type': 'WindShearDataset', 'split': 'val', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 80.0, 'min_points': 50, 'adaptive': True}, {'type': 'ToTensor'}]}, 'test': {'type': 'WindShearDataset', 'split': 'test', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 80.0, 'min_points': 50, 'adaptive': True}, {'type': 'ToTensor'}]}}, 'train': {'epochs': 100, 'optimizer': {'type': 'AdamW', 'lr': 0.001, 'weight_decay': 0.0001}, 'scheduler': {'type': 'CosineAnnealingLR', 'T_max': 100}, 'batch_size': 2, 'num_workers': 4}, 'evaluation': {'interval': 1}, 'checkpoint': {'interval': 5}, 'log': {'interval': 50}}
[2025-09-19 18:01:45,871 INFO train.py line 32 65538] 使用设备: cuda
[2025-09-19 18:01:46,650 ERROR train.py line 51 65538] 打印第一个batch失败: Caught AssertionError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/home/wai/miniconda3/envs/pct/lib/python3.8/site-packages/torch/utils/data/_utils/worker.py", line 308, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/wai/miniconda3/envs/pct/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 51, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/wai/miniconda3/envs/pct/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 51, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/wai/PointTransformerV3/pointcept/datasets/wind_shear.py", line 162, in __getitem__
    data_dict = self.transform(data_dict)
  File "/home/wai/miniconda3/envs/pct/lib/python3.8/site-packages/torchvision/transforms/transforms.py", line 95, in __call__
    img = t(img)
  File "/home/wai/PointTransformerV3/pointcept/datasets/transforms/wind_shear.py", line 174, in __call__
    assert data_dict["beamaz"].shape[
AssertionError: beamaz长度(4784)与采样后点数(3440)不匹配

[2025-09-19 18:01:46,651 INFO train.py line 53 65538] 训练集样本数: 8935, 验证集样本数: 2130
[2025-09-19 18:01:47,097 INFO train.py line 59 65538] 模型类型: PointTransformerV3
[2025-09-19 18:01:47,099 INFO train.py line 83 65538] 
===== Epoch 1/100 =====
[2025-09-19 18:05:06,081 INFO train.py line 27 66214] 使用配置文件: configs/wind_shear/pointtransformer_v3.yaml
[2025-09-19 18:05:06,081 INFO train.py line 28 66214] 配置详情: {'model': {'type': 'PT-v3m1', 'in_channels': 9, 'num_classes': 2, 'cls_mode': False, 'order': ['z', 'z-trans'], 'pdnorm_bn': False, 'pdnorm_ln': False, 'enc_depths': [2, 2, 6, 2], 'enc_channels': [32, 64, 128, 256], 'enc_num_head': [2, 4, 8, 16], 'stride': [2, 2, 2], 'enc_patch_size': [48, 48, 48, 48], 'dec_depths': [2, 2, 2], 'dec_channels': [64, 64, 128], 'dec_num_head': [4, 4, 8], 'dec_patch_size': [48, 48, 48], 'mlp_ratio': 4, 'qkv_bias': True, 'drop_path': 0.3, 'enable_flash': False}, 'data': {'train': {'type': 'WindShearDataset', 'split': 'train', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 80.0, 'min_points': 50, 'adaptive': True}, {'type': 'ToTensor'}]}, 'val': {'type': 'WindShearDataset', 'split': 'val', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 80.0, 'min_points': 50, 'adaptive': True}, {'type': 'ToTensor'}]}, 'test': {'type': 'WindShearDataset', 'split': 'test', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 80.0, 'min_points': 50, 'adaptive': True}, {'type': 'ToTensor'}]}}, 'train': {'epochs': 100, 'optimizer': {'type': 'AdamW', 'lr': 0.001, 'weight_decay': 0.0001}, 'scheduler': {'type': 'CosineAnnealingLR', 'T_max': 100}, 'batch_size': 2, 'num_workers': 4}, 'evaluation': {'interval': 1}, 'checkpoint': {'interval': 5}, 'log': {'interval': 50}}
[2025-09-19 18:05:06,321 INFO train.py line 32 66214] 使用设备: cuda
[2025-09-19 18:05:07,602 INFO train.py line 44 66214] First batch structure (验证collate_fn输出):
[2025-09-19 18:05:07,603 INFO train.py line 47 66214]   offset: shape torch.Size([3]), dtype torch.int64
[2025-09-19 18:05:07,603 INFO train.py line 47 66214]   coord: shape torch.Size([3456, 3]), dtype torch.float32
[2025-09-19 18:05:07,603 INFO train.py line 47 66214]   feat: shape torch.Size([3456, 9]), dtype torch.float32
[2025-09-19 18:05:07,603 INFO train.py line 47 66214]   label: shape torch.Size([3456]), dtype torch.int64
[2025-09-19 18:05:07,603 INFO train.py line 49 66214]   path: type <class 'list'>
[2025-09-19 18:05:07,604 INFO train.py line 47 66214]   beamaz: shape torch.Size([3456]), dtype torch.float32
[2025-09-19 18:05:07,604 INFO train.py line 47 66214]   grid_size: shape torch.Size([3]), dtype torch.float32
[2025-09-19 18:05:07,604 INFO train.py line 53 66214] 训练集样本数: 8935, 验证集样本数: 2130
[2025-09-19 18:05:07,872 INFO train.py line 59 66214] 模型类型: PointTransformerV3
[2025-09-19 18:05:07,874 INFO train.py line 83 66214] 
===== Epoch 1/100 =====
[2025-09-19 18:13:50,101 INFO train.py line 27 67838] 使用配置文件: configs/wind_shear/pointtransformer_v3.yaml
[2025-09-19 18:13:50,101 INFO train.py line 28 67838] 配置详情: {'model': {'type': 'PT-v3m1', 'in_channels': 9, 'num_classes': 2, 'cls_mode': False, 'order': ['z', 'z-trans'], 'pdnorm_bn': False, 'pdnorm_ln': False, 'enc_depths': [2, 2, 6, 2], 'enc_channels': [32, 64, 128, 256], 'enc_num_head': [2, 4, 8, 16], 'stride': [2, 2, 2], 'enc_patch_size': [48, 48, 48, 48], 'dec_depths': [2, 2, 2], 'dec_channels': [64, 64, 128], 'dec_num_head': [4, 4, 8], 'dec_patch_size': [48, 48, 48], 'mlp_ratio': 4, 'qkv_bias': True, 'drop_path': 0.3, 'enable_flash': False}, 'data': {'train': {'type': 'WindShearDataset', 'split': 'train', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 80.0, 'min_points': 50, 'adaptive': True}, {'type': 'ToTensor'}]}, 'val': {'type': 'WindShearDataset', 'split': 'val', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 80.0, 'min_points': 50, 'adaptive': True}, {'type': 'ToTensor'}]}, 'test': {'type': 'WindShearDataset', 'split': 'test', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 80.0, 'min_points': 50, 'adaptive': True}, {'type': 'ToTensor'}]}}, 'train': {'epochs': 100, 'optimizer': {'type': 'AdamW', 'lr': 0.001, 'weight_decay': 0.0001}, 'scheduler': {'type': 'CosineAnnealingLR', 'T_max': 100}, 'batch_size': 2, 'num_workers': 4}, 'evaluation': {'interval': 1}, 'checkpoint': {'interval': 5}, 'log': {'interval': 50}}
[2025-09-19 18:13:50,287 INFO train.py line 32 67838] 使用设备: cuda
[2025-09-19 18:13:50,985 ERROR train.py line 51 67838] 打印第一个batch失败: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/home/wai/miniconda3/envs/pct/lib/python3.8/site-packages/torch/utils/data/_utils/worker.py", line 308, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/wai/miniconda3/envs/pct/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 51, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/wai/miniconda3/envs/pct/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 51, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/wai/PointTransformerV3/pointcept/datasets/wind_shear.py", line 153, in __getitem__
    print(f"样本{idx}（{self.file_paths[idx]}）feat维度: {feat.shape[1]}")  # 必须输出9！
AttributeError: 'WindShearDataset' object has no attribute 'file_paths'

[2025-09-19 18:13:50,985 INFO train.py line 53 67838] 训练集样本数: 8935, 验证集样本数: 2130
[2025-09-19 18:13:51,543 INFO train.py line 59 67838] 模型类型: PointTransformerV3
[2025-09-19 18:13:51,545 INFO train.py line 83 67838] 
===== Epoch 1/100 =====
[2025-09-19 18:15:49,067 INFO train.py line 27 68296] 使用配置文件: configs/wind_shear/pointtransformer_v3.yaml
[2025-09-19 18:15:49,068 INFO train.py line 28 68296] 配置详情: {'model': {'type': 'PT-v3m1', 'in_channels': 9, 'num_classes': 2, 'cls_mode': False, 'order': ['z', 'z-trans'], 'pdnorm_bn': False, 'pdnorm_ln': False, 'enc_depths': [2, 2, 6, 2], 'enc_channels': [32, 64, 128, 256], 'enc_num_head': [2, 4, 8, 16], 'stride': [2, 2, 2], 'enc_patch_size': [48, 48, 48, 48], 'dec_depths': [2, 2, 2], 'dec_channels': [64, 64, 128], 'dec_num_head': [4, 4, 8], 'dec_patch_size': [48, 48, 48], 'mlp_ratio': 4, 'qkv_bias': True, 'drop_path': 0.3, 'enable_flash': False}, 'data': {'train': {'type': 'WindShearDataset', 'split': 'train', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 80.0, 'min_points': 50, 'adaptive': True}, {'type': 'ToTensor'}]}, 'val': {'type': 'WindShearDataset', 'split': 'val', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 80.0, 'min_points': 50, 'adaptive': True}, {'type': 'ToTensor'}]}, 'test': {'type': 'WindShearDataset', 'split': 'test', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 80.0, 'min_points': 50, 'adaptive': True}, {'type': 'ToTensor'}]}}, 'train': {'epochs': 100, 'optimizer': {'type': 'AdamW', 'lr': 0.001, 'weight_decay': 0.0001}, 'scheduler': {'type': 'CosineAnnealingLR', 'T_max': 100}, 'batch_size': 2, 'num_workers': 4}, 'evaluation': {'interval': 1}, 'checkpoint': {'interval': 5}, 'log': {'interval': 50}}
[2025-09-19 18:15:49,352 INFO train.py line 32 68296] 使用设备: cuda
[2025-09-19 18:15:50,091 ERROR train.py line 51 68296] 打印第一个batch失败: Caught TypeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/home/wai/miniconda3/envs/pct/lib/python3.8/site-packages/torch/utils/data/_utils/worker.py", line 308, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/wai/miniconda3/envs/pct/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 54, in fetch
    return self.collate_fn(data)
  File "/home/wai/PointTransformerV3/pointcept/utils/misc.py", line 223, in collate_fn
    feat = torch.cat([torch.from_numpy(item['feat']) for item in batch], dim=0)
  File "/home/wai/PointTransformerV3/pointcept/utils/misc.py", line 223, in <listcomp>
    feat = torch.cat([torch.from_numpy(item['feat']) for item in batch], dim=0)
TypeError: expected np.ndarray (got Tensor)

[2025-09-19 18:15:50,091 INFO train.py line 53 68296] 训练集样本数: 8935, 验证集样本数: 2130
[2025-09-19 18:15:50,579 INFO train.py line 59 68296] 模型类型: PointTransformerV3
[2025-09-19 18:15:50,581 INFO train.py line 83 68296] 
===== Epoch 1/100 =====
[2025-09-19 18:17:50,897 INFO train.py line 27 68746] 使用配置文件: configs/wind_shear/pointtransformer_v3.yaml
[2025-09-19 18:17:50,897 INFO train.py line 28 68746] 配置详情: {'model': {'type': 'PT-v3m1', 'in_channels': 9, 'num_classes': 2, 'cls_mode': False, 'order': ['z', 'z-trans'], 'pdnorm_bn': False, 'pdnorm_ln': False, 'enc_depths': [2, 2, 6, 2], 'enc_channels': [32, 64, 128, 256], 'enc_num_head': [2, 4, 8, 16], 'stride': [2, 2, 2], 'enc_patch_size': [48, 48, 48, 48], 'dec_depths': [2, 2, 2], 'dec_channels': [64, 64, 128], 'dec_num_head': [4, 4, 8], 'dec_patch_size': [48, 48, 48], 'mlp_ratio': 4, 'qkv_bias': True, 'drop_path': 0.3, 'enable_flash': False}, 'data': {'train': {'type': 'WindShearDataset', 'split': 'train', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 80.0, 'min_points': 50, 'adaptive': True}, {'type': 'ToTensor'}]}, 'val': {'type': 'WindShearDataset', 'split': 'val', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 80.0, 'min_points': 50, 'adaptive': True}, {'type': 'ToTensor'}]}, 'test': {'type': 'WindShearDataset', 'split': 'test', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 80.0, 'min_points': 50, 'adaptive': True}, {'type': 'ToTensor'}]}}, 'train': {'epochs': 100, 'optimizer': {'type': 'AdamW', 'lr': 0.001, 'weight_decay': 0.0001}, 'scheduler': {'type': 'CosineAnnealingLR', 'T_max': 100}, 'batch_size': 2, 'num_workers': 4}, 'evaluation': {'interval': 1}, 'checkpoint': {'interval': 5}, 'log': {'interval': 50}}
[2025-09-19 18:17:51,080 INFO train.py line 32 68746] 使用设备: cuda
[2025-09-19 18:17:52,202 INFO train.py line 44 68746] First batch structure (验证collate_fn输出):
[2025-09-19 18:17:52,203 INFO train.py line 47 68746]   offset: shape torch.Size([3]), dtype torch.int64
[2025-09-19 18:17:52,203 INFO train.py line 47 68746]   coord: shape torch.Size([3840, 3]), dtype torch.float32
[2025-09-19 18:17:52,203 INFO train.py line 47 68746]   feat: shape torch.Size([3840, 9]), dtype torch.float32
[2025-09-19 18:17:52,203 INFO train.py line 47 68746]   label: shape torch.Size([3840]), dtype torch.int64
[2025-09-19 18:17:52,204 INFO train.py line 47 68746]   beamaz: shape torch.Size([3840]), dtype torch.float32
[2025-09-19 18:17:52,204 INFO train.py line 47 68746]   grid_size: shape torch.Size([6]), dtype torch.float64
[2025-09-19 18:17:52,204 INFO train.py line 53 68746] 训练集样本数: 8935, 验证集样本数: 2130
[2025-09-19 18:17:52,461 INFO train.py line 59 68746] 模型类型: PointTransformerV3
[2025-09-19 18:17:52,462 INFO train.py line 83 68746] 
===== Epoch 1/100 =====
[2025-09-19 18:19:44,543 INFO train.py line 27 69164] 使用配置文件: configs/wind_shear/pointtransformer_v3.yaml
[2025-09-19 18:19:44,544 INFO train.py line 28 69164] 配置详情: {'model': {'type': 'PT-v3m1', 'in_channels': 9, 'num_classes': 2, 'cls_mode': False, 'order': ['z', 'z-trans'], 'pdnorm_bn': False, 'pdnorm_ln': False, 'enc_depths': [2, 2, 6, 2], 'enc_channels': [32, 64, 128, 256], 'enc_num_head': [2, 4, 8, 16], 'stride': [2, 2, 2], 'enc_patch_size': [48, 48, 48, 48], 'dec_depths': [2, 2, 2], 'dec_channels': [64, 64, 128], 'dec_num_head': [4, 4, 8], 'dec_patch_size': [48, 48, 48], 'mlp_ratio': 4, 'qkv_bias': True, 'drop_path': 0.3, 'enable_flash': False}, 'data': {'train': {'type': 'WindShearDataset', 'split': 'train', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 80.0, 'min_points': 50, 'adaptive': True}, {'type': 'ToTensor'}]}, 'val': {'type': 'WindShearDataset', 'split': 'val', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 80.0, 'min_points': 50, 'adaptive': True}, {'type': 'ToTensor'}]}, 'test': {'type': 'WindShearDataset', 'split': 'test', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 80.0, 'min_points': 50, 'adaptive': True}, {'type': 'ToTensor'}]}}, 'train': {'epochs': 100, 'optimizer': {'type': 'AdamW', 'lr': 0.001, 'weight_decay': 0.0001}, 'scheduler': {'type': 'CosineAnnealingLR', 'T_max': 100}, 'batch_size': 2, 'num_workers': 4}, 'evaluation': {'interval': 1}, 'checkpoint': {'interval': 5}, 'log': {'interval': 50}}
[2025-09-19 18:19:44,762 INFO train.py line 32 69164] 使用设备: cuda
[2025-09-19 18:19:46,252 INFO train.py line 44 69164] First batch structure (验证collate_fn输出):
[2025-09-19 18:19:46,253 INFO train.py line 47 69164]   offset: shape torch.Size([3]), dtype torch.int64
[2025-09-19 18:19:46,253 INFO train.py line 47 69164]   coord: shape torch.Size([3456, 3]), dtype torch.float32
[2025-09-19 18:19:46,254 INFO train.py line 47 69164]   feat: shape torch.Size([3456, 9]), dtype torch.float32
[2025-09-19 18:19:46,254 INFO train.py line 47 69164]   label: shape torch.Size([3456]), dtype torch.int64
[2025-09-19 18:19:46,255 INFO train.py line 47 69164]   beamaz: shape torch.Size([3456]), dtype torch.float32
[2025-09-19 18:19:46,255 INFO train.py line 47 69164]   grid_size: shape torch.Size([3]), dtype torch.float32
[2025-09-19 18:19:46,255 INFO train.py line 53 69164] 训练集样本数: 8935, 验证集样本数: 2130
[2025-09-19 18:19:46,567 INFO train.py line 59 69164] 模型类型: PointTransformerV3
[2025-09-19 18:19:46,568 INFO train.py line 83 69164] 
===== Epoch 1/100 =====
[2025-09-19 18:44:18,167 INFO train.py line 27 73980] 使用配置文件: configs/wind_shear/pointtransformer_v3.yaml
[2025-09-19 18:44:18,167 INFO train.py line 28 73980] 配置详情: {'model': {'type': 'PT-v3m1', 'in_channels': 9, 'num_classes': 2, 'cls_mode': False, 'order': ['z', 'z-trans'], 'pdnorm_bn': False, 'pdnorm_ln': False, 'enc_depths': [2, 2, 6, 2], 'enc_channels': [32, 64, 128, 256], 'enc_num_head': [2, 4, 8, 16], 'stride': [2, 2, 2], 'enc_patch_size': [48, 48, 48, 48], 'dec_depths': [2, 2, 2], 'dec_channels': [64, 64, 128], 'dec_num_head': [4, 4, 8], 'dec_patch_size': [48, 48, 48], 'mlp_ratio': 4, 'qkv_bias': True, 'drop_path': 0.3, 'enable_flash': False}, 'data': {'train': {'type': 'WindShearDataset', 'split': 'train', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 80.0, 'min_points': 50, 'adaptive': True}, {'type': 'ToTensor'}]}, 'val': {'type': 'WindShearDataset', 'split': 'val', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 80.0, 'min_points': 50, 'adaptive': True}, {'type': 'ToTensor'}]}, 'test': {'type': 'WindShearDataset', 'split': 'test', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 80.0, 'min_points': 50, 'adaptive': True}, {'type': 'ToTensor'}]}}, 'train': {'epochs': 100, 'optimizer': {'type': 'AdamW', 'lr': 0.001, 'weight_decay': 0.0001}, 'scheduler': {'type': 'CosineAnnealingLR', 'T_max': 100}, 'batch_size': 2, 'num_workers': 4}, 'evaluation': {'interval': 1}, 'checkpoint': {'interval': 5}, 'log': {'interval': 50}}
[2025-09-19 18:44:18,490 INFO train.py line 32 73980] 使用设备: cuda
[2025-09-19 18:44:19,752 INFO train.py line 44 73980] First batch structure (验证collate_fn输出):
[2025-09-19 18:44:19,753 INFO train.py line 47 73980]   offset: shape torch.Size([3]), dtype torch.int64
[2025-09-19 18:44:19,753 INFO train.py line 47 73980]   coord: shape torch.Size([3456, 3]), dtype torch.float32
[2025-09-19 18:44:19,753 INFO train.py line 47 73980]   feat: shape torch.Size([3456, 9]), dtype torch.float32
[2025-09-19 18:44:19,753 INFO train.py line 47 73980]   label: shape torch.Size([3456]), dtype torch.int64
[2025-09-19 18:44:19,753 INFO train.py line 47 73980]   beamaz: shape torch.Size([3456]), dtype torch.float32
[2025-09-19 18:44:19,753 INFO train.py line 47 73980]   grid_size: shape torch.Size([3]), dtype torch.float32
[2025-09-19 18:44:19,753 INFO train.py line 53 73980] 训练集样本数: 8935, 验证集样本数: 2130
[2025-09-19 18:44:20,020 INFO train.py line 59 73980] 模型类型: PointTransformerV3
[2025-09-19 18:44:20,022 INFO train.py line 83 73980] 
===== Epoch 1/100 =====
[2025-09-19 18:53:05,613 INFO train.py line 27 75596] 使用配置文件: configs/wind_shear/pointtransformer_v3.yaml
[2025-09-19 18:53:05,613 INFO train.py line 28 75596] 配置详情: {'model': {'type': 'PT-v3m1', 'in_channels': 9, 'num_classes': 2, 'cls_mode': False, 'order': ['z', 'z-trans'], 'pdnorm_bn': False, 'pdnorm_ln': False, 'enc_depths': [2, 2, 6, 2], 'enc_channels': [32, 64, 128, 256], 'enc_num_head': [2, 4, 8, 16], 'stride': [2, 2, 2], 'enc_patch_size': [48, 48, 48, 48], 'dec_depths': [2, 2, 2], 'dec_channels': [64, 64, 128], 'dec_num_head': [4, 4, 8], 'dec_patch_size': [48, 48, 48], 'mlp_ratio': 4, 'qkv_bias': True, 'drop_path': 0.3, 'enable_flash': False}, 'data': {'train': {'type': 'WindShearDataset', 'split': 'train', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 80.0, 'min_points': 50, 'adaptive': True}, {'type': 'ToTensor'}]}, 'val': {'type': 'WindShearDataset', 'split': 'val', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 80.0, 'min_points': 50, 'adaptive': True}, {'type': 'ToTensor'}]}, 'test': {'type': 'WindShearDataset', 'split': 'test', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 80.0, 'min_points': 50, 'adaptive': True}, {'type': 'ToTensor'}]}}, 'train': {'epochs': 100, 'optimizer': {'type': 'AdamW', 'lr': 0.001, 'weight_decay': 0.0001}, 'scheduler': {'type': 'CosineAnnealingLR', 'T_max': 100}, 'batch_size': 2, 'num_workers': 4}, 'evaluation': {'interval': 1}, 'checkpoint': {'interval': 5}, 'log': {'interval': 50}}
[2025-09-19 18:53:05,834 INFO train.py line 32 75596] 使用设备: cuda
[2025-09-19 18:53:06,878 INFO train.py line 44 75596] First batch structure (验证collate_fn输出):
[2025-09-19 18:53:06,878 INFO train.py line 47 75596]   offset: shape torch.Size([3]), dtype torch.int64
[2025-09-19 18:53:06,878 INFO train.py line 47 75596]   coord: shape torch.Size([3456, 3]), dtype torch.float32
[2025-09-19 18:53:06,878 INFO train.py line 47 75596]   feat: shape torch.Size([3456, 9]), dtype torch.float32
[2025-09-19 18:53:06,878 INFO train.py line 47 75596]   label: shape torch.Size([3456]), dtype torch.int64
[2025-09-19 18:53:06,878 INFO train.py line 47 75596]   beamaz: shape torch.Size([3456]), dtype torch.float32
[2025-09-19 18:53:06,878 INFO train.py line 47 75596]   grid_size: shape torch.Size([3]), dtype torch.float32
[2025-09-19 18:53:06,878 INFO train.py line 53 75596] 训练集样本数: 8935, 验证集样本数: 2130
[2025-09-19 18:53:07,165 INFO train.py line 59 75596] 模型类型: PointTransformerV3
[2025-09-19 18:53:07,167 INFO train.py line 83 75596] 
===== Epoch 1/100 =====
[2025-09-19 19:06:07,418 INFO train.py line 27 77966] 使用配置文件: configs/wind_shear/pointtransformer_v3.yaml
[2025-09-19 19:06:07,418 INFO train.py line 28 77966] 配置详情: {'model': {'type': 'PT-v3m1', 'in_channels': 9, 'num_classes': 2, 'cls_mode': False, 'order': ['z', 'z-trans'], 'pdnorm_bn': False, 'pdnorm_ln': False, 'enc_depths': [2, 2, 6, 2], 'enc_channels': [32, 64, 128, 256], 'enc_num_head': [2, 4, 8, 16], 'stride': [2, 2, 2], 'enc_patch_size': [48, 48, 48, 48], 'dec_depths': [2, 2, 2], 'dec_channels': [64, 64, 128], 'dec_num_head': [4, 4, 8], 'dec_patch_size': [48, 48, 48], 'mlp_ratio': 4, 'qkv_bias': True, 'drop_path': 0.3, 'enable_flash': False}, 'data': {'train': {'type': 'WindShearDataset', 'split': 'train', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 80.0, 'min_points': 50, 'adaptive': True}, {'type': 'ToTensor'}]}, 'val': {'type': 'WindShearDataset', 'split': 'val', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 80.0, 'min_points': 50, 'adaptive': True}, {'type': 'ToTensor'}]}, 'test': {'type': 'WindShearDataset', 'split': 'test', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 80.0, 'min_points': 50, 'adaptive': True}, {'type': 'ToTensor'}]}}, 'train': {'epochs': 100, 'optimizer': {'type': 'AdamW', 'lr': 0.001, 'weight_decay': 0.0001}, 'scheduler': {'type': 'CosineAnnealingLR', 'T_max': 100}, 'batch_size': 2, 'num_workers': 4}, 'evaluation': {'interval': 1}, 'checkpoint': {'interval': 5}, 'log': {'interval': 50}}
[2025-09-19 19:06:07,617 INFO train.py line 32 77966] 使用设备: cuda
[2025-09-19 19:06:08,371 ERROR train.py line 51 77966] 打印第一个batch失败: Caught ValueError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/home/wai/miniconda3/envs/pct/lib/python3.8/site-packages/torch/utils/data/_utils/worker.py", line 308, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/wai/miniconda3/envs/pct/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 54, in fetch
    return self.collate_fn(data)
  File "/home/wai/PointTransformerV3/pointcept/utils/misc.py", line 284, in collate_fn
    raise ValueError(
ValueError: 样本0的coord异常：维度=2，点数=1536
需与coord点数1536一致（1维张量）

[2025-09-19 19:06:08,372 INFO train.py line 53 77966] 训练集样本数: 8935, 验证集样本数: 2130
[2025-09-19 19:06:08,833 INFO train.py line 59 77966] 模型类型: PointTransformerV3
[2025-09-19 19:06:08,834 INFO train.py line 83 77966] 
===== Epoch 1/100 =====
[2025-09-19 19:08:26,826 INFO train.py line 27 78465] 使用配置文件: configs/wind_shear/pointtransformer_v3.yaml
[2025-09-19 19:08:26,826 INFO train.py line 28 78465] 配置详情: {'model': {'type': 'PT-v3m1', 'in_channels': 9, 'num_classes': 2, 'cls_mode': False, 'order': ['z', 'z-trans'], 'pdnorm_bn': False, 'pdnorm_ln': False, 'enc_depths': [2, 2, 6, 2], 'enc_channels': [32, 64, 128, 256], 'enc_num_head': [2, 4, 8, 16], 'stride': [2, 2, 2], 'enc_patch_size': [48, 48, 48, 48], 'dec_depths': [2, 2, 2], 'dec_channels': [64, 64, 128], 'dec_num_head': [4, 4, 8], 'dec_patch_size': [48, 48, 48], 'mlp_ratio': 4, 'qkv_bias': True, 'drop_path': 0.3, 'enable_flash': False}, 'data': {'train': {'type': 'WindShearDataset', 'split': 'train', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 80.0, 'min_points': 50, 'adaptive': True}, {'type': 'ToTensor'}]}, 'val': {'type': 'WindShearDataset', 'split': 'val', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 80.0, 'min_points': 50, 'adaptive': True}, {'type': 'ToTensor'}]}, 'test': {'type': 'WindShearDataset', 'split': 'test', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 80.0, 'min_points': 50, 'adaptive': True}, {'type': 'ToTensor'}]}}, 'train': {'epochs': 100, 'optimizer': {'type': 'AdamW', 'lr': 0.001, 'weight_decay': 0.0001}, 'scheduler': {'type': 'CosineAnnealingLR', 'T_max': 100}, 'batch_size': 2, 'num_workers': 4}, 'evaluation': {'interval': 1}, 'checkpoint': {'interval': 5}, 'log': {'interval': 50}}
[2025-09-19 19:08:27,006 INFO train.py line 32 78465] 使用设备: cuda
[2025-09-19 19:08:28,231 INFO train.py line 44 78465] First batch structure (验证collate_fn输出):
[2025-09-19 19:08:28,232 INFO train.py line 47 78465]   offset: shape torch.Size([3]), dtype torch.int64
[2025-09-19 19:08:28,232 INFO train.py line 47 78465]   coord: shape torch.Size([3456, 3]), dtype torch.float32
[2025-09-19 19:08:28,233 INFO train.py line 47 78465]   feat: shape torch.Size([3456, 9]), dtype torch.float32
[2025-09-19 19:08:28,233 INFO train.py line 47 78465]   label: shape torch.Size([3456]), dtype torch.int64
[2025-09-19 19:08:28,233 INFO train.py line 47 78465]   beamaz: shape torch.Size([3456]), dtype torch.float32
[2025-09-19 19:08:28,233 INFO train.py line 49 78465]   grid_size: type <class 'list'>
[2025-09-19 19:08:28,233 INFO train.py line 49 78465]   path: type <class 'list'>
[2025-09-19 19:08:28,233 INFO train.py line 53 78465] 训练集样本数: 8935, 验证集样本数: 2130
[2025-09-19 19:08:28,492 INFO train.py line 59 78465] 模型类型: PointTransformerV3
[2025-09-19 19:08:28,494 INFO train.py line 83 78465] 
===== Epoch 1/100 =====
[2025-09-19 19:11:09,435 INFO train.py line 27 79030] 使用配置文件: configs/wind_shear/pointtransformer_v3.yaml
[2025-09-19 19:11:09,435 INFO train.py line 28 79030] 配置详情: {'model': {'type': 'PT-v3m1', 'in_channels': 9, 'num_classes': 2, 'cls_mode': False, 'order': ['z', 'z-trans'], 'pdnorm_bn': False, 'pdnorm_ln': False, 'enc_depths': [2, 2, 6, 2], 'enc_channels': [32, 64, 128, 256], 'enc_num_head': [2, 4, 8, 16], 'stride': [2, 2, 2], 'enc_patch_size': [48, 48, 48, 48], 'dec_depths': [2, 2, 2], 'dec_channels': [64, 64, 128], 'dec_num_head': [4, 4, 8], 'dec_patch_size': [48, 48, 48], 'mlp_ratio': 4, 'qkv_bias': True, 'drop_path': 0.3, 'enable_flash': False}, 'data': {'train': {'type': 'WindShearDataset', 'split': 'train', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 80.0, 'min_points': 50, 'adaptive': True}, {'type': 'ToTensor'}]}, 'val': {'type': 'WindShearDataset', 'split': 'val', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 80.0, 'min_points': 50, 'adaptive': True}, {'type': 'ToTensor'}]}, 'test': {'type': 'WindShearDataset', 'split': 'test', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 80.0, 'min_points': 50, 'adaptive': True}, {'type': 'ToTensor'}]}}, 'train': {'epochs': 100, 'optimizer': {'type': 'AdamW', 'lr': 0.001, 'weight_decay': 0.0001}, 'scheduler': {'type': 'CosineAnnealingLR', 'T_max': 100}, 'batch_size': 2, 'num_workers': 4}, 'evaluation': {'interval': 1}, 'checkpoint': {'interval': 5}, 'log': {'interval': 50}}
[2025-09-19 19:11:09,637 INFO train.py line 32 79030] 使用设备: cuda
[2025-09-19 19:11:10,870 INFO train.py line 44 79030] First batch structure (验证collate_fn输出):
[2025-09-19 19:11:10,871 INFO train.py line 47 79030]   offset: shape torch.Size([3]), dtype torch.int64
[2025-09-19 19:11:10,871 INFO train.py line 47 79030]   coord: shape torch.Size([3840, 3]), dtype torch.float32
[2025-09-19 19:11:10,871 INFO train.py line 47 79030]   feat: shape torch.Size([3840, 9]), dtype torch.float32
[2025-09-19 19:11:10,871 INFO train.py line 47 79030]   label: shape torch.Size([3840]), dtype torch.int64
[2025-09-19 19:11:10,871 INFO train.py line 47 79030]   beamaz: shape torch.Size([3840]), dtype torch.float32
[2025-09-19 19:11:10,871 INFO train.py line 47 79030]   grid_size: shape torch.Size([3]), dtype torch.float32
[2025-09-19 19:11:10,871 INFO train.py line 49 79030]   path: type <class 'list'>
[2025-09-19 19:11:10,871 INFO train.py line 53 79030] 训练集样本数: 8935, 验证集样本数: 2130
[2025-09-19 19:11:11,000 INFO train.py line 59 79030] 模型类型: PointTransformerV3
[2025-09-19 19:11:11,002 INFO train.py line 83 79030] 
===== Epoch 1/100 =====
[2025-09-19 19:39:52,398 INFO train.py line 27 84307] 使用配置文件: configs/wind_shear/pointtransformer_v3.yaml
[2025-09-19 19:39:52,399 INFO train.py line 28 84307] 配置详情: {'model': {'type': 'PT-v3m1', 'in_channels': 9, 'num_classes': 2, 'cls_mode': False, 'order': ['z', 'z-trans'], 'pdnorm_bn': False, 'pdnorm_ln': False, 'enc_depths': [2, 2, 6, 2], 'enc_channels': [32, 64, 128, 256], 'enc_num_head': [2, 4, 8, 16], 'stride': [2, 2, 2], 'enc_patch_size': [48, 48, 48, 48], 'dec_depths': [2, 2, 2], 'dec_channels': [64, 64, 128], 'dec_num_head': [4, 4, 8], 'dec_patch_size': [48, 48, 48], 'mlp_ratio': 4, 'qkv_bias': True, 'drop_path': 0.3, 'enable_flash': False}, 'data': {'train': {'type': 'WindShearDataset', 'split': 'train', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 80.0, 'min_points': 50, 'adaptive': True}, {'type': 'ToTensor'}]}, 'val': {'type': 'WindShearDataset', 'split': 'val', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 80.0, 'min_points': 50, 'adaptive': True}, {'type': 'ToTensor'}]}, 'test': {'type': 'WindShearDataset', 'split': 'test', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 80.0, 'min_points': 50, 'adaptive': True}, {'type': 'ToTensor'}]}}, 'train': {'epochs': 100, 'optimizer': {'type': 'AdamW', 'lr': 0.001, 'weight_decay': 0.0001}, 'scheduler': {'type': 'CosineAnnealingLR', 'T_max': 100}, 'batch_size': 2, 'num_workers': 4}, 'evaluation': {'interval': 1}, 'checkpoint': {'interval': 5}, 'log': {'interval': 50}}
[2025-09-19 19:39:52,704 INFO train.py line 32 84307] 使用设备: cuda
[2025-09-19 19:39:53,840 INFO train.py line 44 84307] First batch structure (验证collate_fn输出):
[2025-09-19 19:39:53,840 INFO train.py line 47 84307]   offset: shape torch.Size([3]), dtype torch.int64
[2025-09-19 19:39:53,840 INFO train.py line 47 84307]   coord: shape torch.Size([3072, 3]), dtype torch.float32
[2025-09-19 19:39:53,840 INFO train.py line 47 84307]   feat: shape torch.Size([3072, 9]), dtype torch.float32
[2025-09-19 19:39:53,841 INFO train.py line 47 84307]   label: shape torch.Size([3072]), dtype torch.int64
[2025-09-19 19:39:53,841 INFO train.py line 47 84307]   beamaz: shape torch.Size([3072]), dtype torch.float32
[2025-09-19 19:39:53,841 INFO train.py line 47 84307]   grid_size: shape torch.Size([3]), dtype torch.float32
[2025-09-19 19:39:53,841 INFO train.py line 49 84307]   path: type <class 'list'>
[2025-09-19 19:39:53,841 INFO train.py line 53 84307] 训练集样本数: 8935, 验证集样本数: 2130
[2025-09-19 19:39:54,087 INFO train.py line 59 84307] 模型类型: PointTransformerV3
[2025-09-19 19:39:54,089 INFO train.py line 83 84307] 
===== Epoch 1/100 =====
[2025-09-19 19:44:29,261 INFO train.py line 27 85332] 使用配置文件: configs/wind_shear/pointtransformer_v3.yaml
[2025-09-19 19:44:29,261 INFO train.py line 28 85332] 配置详情: {'model': {'type': 'PT-v3m1', 'in_channels': 9, 'num_classes': 2, 'cls_mode': False, 'order': ['z', 'z-trans'], 'pdnorm_bn': False, 'pdnorm_ln': False, 'enc_depths': [2, 2, 6, 2], 'enc_channels': [32, 64, 128, 256], 'enc_num_head': [2, 4, 8, 16], 'stride': [2, 2, 2], 'enc_patch_size': [48, 48, 48, 48], 'dec_depths': [2, 2, 2], 'dec_channels': [64, 64, 128], 'dec_num_head': [4, 4, 8], 'dec_patch_size': [48, 48, 48], 'mlp_ratio': 4, 'qkv_bias': True, 'drop_path': 0.3, 'enable_flash': False}, 'data': {'train': {'type': 'WindShearDataset', 'split': 'train', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 80.0, 'min_points': 50, 'adaptive': True}, {'type': 'ToTensor'}]}, 'val': {'type': 'WindShearDataset', 'split': 'val', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 80.0, 'min_points': 50, 'adaptive': True}, {'type': 'ToTensor'}]}, 'test': {'type': 'WindShearDataset', 'split': 'test', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 80.0, 'min_points': 50, 'adaptive': True}, {'type': 'ToTensor'}]}}, 'train': {'epochs': 100, 'optimizer': {'type': 'AdamW', 'lr': 0.001, 'weight_decay': 0.0001}, 'scheduler': {'type': 'CosineAnnealingLR', 'T_max': 100}, 'batch_size': 2, 'num_workers': 4}, 'evaluation': {'interval': 1}, 'checkpoint': {'interval': 5}, 'log': {'interval': 50}}
[2025-09-19 19:44:29,545 INFO train.py line 32 85332] 使用设备: cuda
[2025-09-19 19:44:30,550 INFO train.py line 44 85332] First batch structure (验证collate_fn输出):
[2025-09-19 19:44:30,550 INFO train.py line 47 85332]   offset: shape torch.Size([3]), dtype torch.int64
[2025-09-19 19:44:30,550 INFO train.py line 47 85332]   coord: shape torch.Size([3840, 3]), dtype torch.float32
[2025-09-19 19:44:30,550 INFO train.py line 47 85332]   feat: shape torch.Size([3840, 9]), dtype torch.float32
[2025-09-19 19:44:30,550 INFO train.py line 47 85332]   label: shape torch.Size([3840]), dtype torch.int64
[2025-09-19 19:44:30,550 INFO train.py line 47 85332]   beamaz: shape torch.Size([3840]), dtype torch.float32
[2025-09-19 19:44:30,550 INFO train.py line 47 85332]   grid_size: shape torch.Size([3]), dtype torch.float32
[2025-09-19 19:44:30,550 INFO train.py line 49 85332]   path: type <class 'list'>
[2025-09-19 19:44:30,550 INFO train.py line 53 85332] 训练集样本数: 8935, 验证集样本数: 2130
[2025-09-19 19:44:30,804 INFO train.py line 59 85332] 模型类型: PointTransformerV3
[2025-09-19 19:44:30,806 INFO train.py line 83 85332] 
===== Epoch 1/100 =====
[2025-09-19 19:51:05,719 INFO train.py line 27 86753] 使用配置文件: configs/wind_shear/pointtransformer_v3.yaml
[2025-09-19 19:51:05,719 INFO train.py line 28 86753] 配置详情: {'model': {'type': 'PT-v3m1', 'in_channels': 9, 'num_classes': 2, 'cls_mode': False, 'order': ['z', 'z-trans'], 'pdnorm_bn': False, 'pdnorm_ln': False, 'enc_depths': [2, 2, 6, 2], 'enc_channels': [32, 64, 128, 256], 'enc_num_head': [2, 4, 8, 16], 'stride': [2, 2, 2], 'enc_patch_size': [48, 48, 48, 48], 'dec_depths': [2, 2, 2], 'dec_channels': [64, 64, 128], 'dec_num_head': [4, 4, 8], 'dec_patch_size': [48, 48, 48], 'mlp_ratio': 4, 'qkv_bias': True, 'drop_path': 0.3, 'enable_flash': False}, 'data': {'train': {'type': 'WindShearDataset', 'split': 'train', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 80.0, 'min_points': 50, 'adaptive': True}, {'type': 'ToTensor'}]}, 'val': {'type': 'WindShearDataset', 'split': 'val', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 80.0, 'min_points': 50, 'adaptive': True}, {'type': 'ToTensor'}]}, 'test': {'type': 'WindShearDataset', 'split': 'test', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 80.0, 'min_points': 50, 'adaptive': True}, {'type': 'ToTensor'}]}}, 'train': {'epochs': 100, 'optimizer': {'type': 'AdamW', 'lr': 0.001, 'weight_decay': 0.0001}, 'scheduler': {'type': 'CosineAnnealingLR', 'T_max': 100}, 'batch_size': 2, 'num_workers': 4}, 'evaluation': {'interval': 1}, 'checkpoint': {'interval': 5}, 'log': {'interval': 50}}
[2025-09-19 19:51:05,981 INFO train.py line 32 86753] 使用设备: cuda
[2025-09-19 19:51:06,867 INFO train.py line 44 86753] First batch structure (验证collate_fn输出):
[2025-09-19 19:51:06,867 INFO train.py line 47 86753]   offset: shape torch.Size([3]), dtype torch.int64
[2025-09-19 19:51:06,868 INFO train.py line 47 86753]   coord: shape torch.Size([3456, 3]), dtype torch.float32
[2025-09-19 19:51:06,868 INFO train.py line 47 86753]   feat: shape torch.Size([3456, 9]), dtype torch.float32
[2025-09-19 19:51:06,868 INFO train.py line 47 86753]   label: shape torch.Size([3456]), dtype torch.int64
[2025-09-19 19:51:06,868 INFO train.py line 47 86753]   beamaz: shape torch.Size([3456]), dtype torch.float32
[2025-09-19 19:51:06,868 INFO train.py line 47 86753]   grid_size: shape torch.Size([3]), dtype torch.float32
[2025-09-19 19:51:06,868 INFO train.py line 49 86753]   path: type <class 'list'>
[2025-09-19 19:51:06,868 INFO train.py line 53 86753] 训练集样本数: 8935, 验证集样本数: 2130
[2025-09-19 19:51:07,136 INFO train.py line 59 86753] 模型类型: PointTransformerV3
[2025-09-19 19:51:07,137 INFO train.py line 83 86753] 
===== Epoch 1/100 =====
[2025-09-19 19:59:13,367 INFO train.py line 27 88375] 使用配置文件: configs/wind_shear/pointtransformer_v3.yaml
[2025-09-19 19:59:13,367 INFO train.py line 28 88375] 配置详情: {'model': {'type': 'PT-v3m1', 'in_channels': 9, 'num_classes': 2, 'cls_mode': False, 'order': ['z', 'z-trans'], 'pdnorm_bn': False, 'pdnorm_ln': False, 'enc_depths': [2, 2, 6, 2], 'enc_channels': [32, 64, 128, 256], 'enc_num_head': [2, 4, 8, 16], 'stride': [2, 2, 2], 'enc_patch_size': [48, 48, 48, 48], 'dec_depths': [2, 2, 2], 'dec_channels': [64, 64, 128], 'dec_num_head': [4, 4, 8], 'dec_patch_size': [48, 48, 48], 'mlp_ratio': 4, 'qkv_bias': True, 'drop_path': 0.3, 'enable_flash': False}, 'data': {'train': {'type': 'WindShearDataset', 'split': 'train', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 80.0, 'min_points': 50, 'adaptive': True}, {'type': 'ToTensor'}]}, 'val': {'type': 'WindShearDataset', 'split': 'val', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 80.0, 'min_points': 50, 'adaptive': True}, {'type': 'ToTensor'}]}, 'test': {'type': 'WindShearDataset', 'split': 'test', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 80.0, 'min_points': 50, 'adaptive': True}, {'type': 'ToTensor'}]}}, 'train': {'epochs': 100, 'optimizer': {'type': 'AdamW', 'lr': 0.001, 'weight_decay': 0.0001}, 'scheduler': {'type': 'CosineAnnealingLR', 'T_max': 100}, 'batch_size': 2, 'num_workers': 4}, 'evaluation': {'interval': 1}, 'checkpoint': {'interval': 5}, 'log': {'interval': 50}}
[2025-09-19 19:59:13,556 INFO train.py line 32 88375] 使用设备: cuda
[2025-09-19 19:59:14,433 INFO train.py line 44 88375] First batch structure (验证collate_fn输出):
[2025-09-19 19:59:14,434 INFO train.py line 47 88375]   offset: shape torch.Size([3]), dtype torch.int64
[2025-09-19 19:59:14,434 INFO train.py line 47 88375]   coord: shape torch.Size([3456, 3]), dtype torch.float32
[2025-09-19 19:59:14,434 INFO train.py line 47 88375]   feat: shape torch.Size([3456, 9]), dtype torch.float32
[2025-09-19 19:59:14,434 INFO train.py line 47 88375]   label: shape torch.Size([3456]), dtype torch.int64
[2025-09-19 19:59:14,434 INFO train.py line 47 88375]   beamaz: shape torch.Size([3456]), dtype torch.float32
[2025-09-19 19:59:14,434 INFO train.py line 47 88375]   grid_size: shape torch.Size([3]), dtype torch.float32
[2025-09-19 19:59:14,434 INFO train.py line 49 88375]   path: type <class 'list'>
[2025-09-19 19:59:14,434 INFO train.py line 53 88375] 训练集样本数: 8935, 验证集样本数: 2130
[2025-09-19 19:59:14,560 INFO train.py line 59 88375] 模型类型: PointTransformerV3
[2025-09-19 19:59:14,562 INFO train.py line 83 88375] 
===== Epoch 1/100 =====
[2025-09-19 20:12:24,045 INFO train.py line 27 90970] 使用配置文件: configs/wind_shear/pointtransformer_v3.yaml
[2025-09-19 20:12:24,046 INFO train.py line 28 90970] 配置详情: {'model': {'type': 'PT-v3m1', 'in_channels': 9, 'num_classes': 2, 'cls_mode': False, 'order': ['z', 'z-trans'], 'pdnorm_bn': False, 'pdnorm_ln': False, 'enc_depths': [2, 2, 6, 2], 'enc_channels': [32, 64, 128, 256], 'enc_num_head': [2, 4, 8, 16], 'stride': [2, 2, 2], 'enc_patch_size': [48, 48, 48, 48], 'dec_depths': [2, 2, 2], 'dec_channels': [64, 64, 128], 'dec_num_head': [4, 4, 8], 'dec_patch_size': [48, 48, 48], 'mlp_ratio': 4, 'qkv_bias': True, 'drop_path': 0.3, 'enable_flash': False}, 'data': {'train': {'type': 'WindShearDataset', 'split': 'train', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 80.0, 'min_points': 50, 'adaptive': True}, {'type': 'ToTensor'}]}, 'val': {'type': 'WindShearDataset', 'split': 'val', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 80.0, 'min_points': 50, 'adaptive': True}, {'type': 'ToTensor'}]}, 'test': {'type': 'WindShearDataset', 'split': 'test', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': 80.0, 'min_points': 50, 'adaptive': True}, {'type': 'ToTensor'}]}}, 'train': {'epochs': 100, 'optimizer': {'type': 'AdamW', 'lr': 0.001, 'weight_decay': 0.0001}, 'scheduler': {'type': 'CosineAnnealingLR', 'T_max': 100}, 'batch_size': 2, 'num_workers': 4}, 'evaluation': {'interval': 1}, 'checkpoint': {'interval': 5}, 'log': {'interval': 50}}
[2025-09-19 20:12:24,315 INFO train.py line 32 90970] 使用设备: cuda
[2025-09-19 20:12:24,980 ERROR train.py line 51 90970] 打印第一个batch失败: Caught ValueError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/home/wai/miniconda3/envs/pct/lib/python3.8/site-packages/torch/utils/data/_utils/worker.py", line 308, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/wai/miniconda3/envs/pct/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 51, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/wai/miniconda3/envs/pct/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 51, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/wai/PointTransformerV3/pointcept/datasets/wind_shear.py", line 162, in __getitem__
    data_dict = self.transform(data_dict)
  File "/home/wai/miniconda3/envs/pct/lib/python3.8/site-packages/torchvision/transforms/transforms.py", line 95, in __call__
    img = t(img)
  File "/home/wai/PointTransformerV3/pointcept/datasets/transforms/wind_shear.py", line 116, in __call__
    raise ValueError(f"{sample_path}采样后点数({sampled_num})小于最小要求({self.min_points})")
ValueError: /mnt/d/model/wind_datas/csv_labels/20230308/datas1/i12_labeled.csv采样后点数(3)小于最小要求(50)

[2025-09-19 20:12:24,980 INFO train.py line 53 90970] 训练集样本数: 8935, 验证集样本数: 2130
[2025-09-19 20:12:25,392 INFO train.py line 59 90970] 模型类型: PointTransformerV3
[2025-09-19 20:12:25,393 INFO train.py line 83 90970] 
===== Epoch 1/100 =====
[2025-09-19 20:52:48,475 INFO train.py line 29 98867] 使用配置文件: configs/wind_shear/pointtransformer_v3.yaml
[2025-09-19 20:52:48,475 INFO train.py line 30 98867] 配置详情: {'model': {'type': 'PT-v3m1', 'in_channels': 9, 'num_classes': 2, 'cls_mode': False, 'order': ['z', 'z-trans'], 'pdnorm_bn': False, 'pdnorm_ln': False, 'enc_depths': [2, 2, 6, 2], 'enc_channels': [32, 64, 128, 256], 'enc_num_head': [2, 4, 8, 16], 'stride': [2, 2, 2], 'enc_patch_size': [48, 48, 48, 48], 'dec_depths': [2, 2, 2], 'dec_channels': [64, 64, 128], 'dec_num_head': [4, 4, 8], 'dec_patch_size': [48, 48, 48], 'mlp_ratio': 4, 'qkv_bias': True, 'drop_path': 0.3, 'enable_flash': False}, 'data': {'train': {'type': 'WindShearDataset', 'split': 'train', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': [122.6, 118.0, 5.4], 'min_points': 50, 'adaptive': False}, {'type': 'ToTensor'}]}, 'val': {'type': 'WindShearDataset', 'split': 'val', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': [122.6, 118.0, 5.4], 'min_points': 50, 'adaptive': False}, {'type': 'ToTensor'}]}, 'test': {'type': 'WindShearDataset', 'split': 'test', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': [122.6, 118.0, 5.4], 'min_points': 50, 'adaptive': False}, {'type': 'ToTensor'}]}}, 'train': {'epochs': 100, 'optimizer': {'type': 'AdamW', 'lr': 0.001, 'weight_decay': 0.0001}, 'scheduler': {'type': 'CosineAnnealingLR', 'T_max': 100}, 'batch_size': 2, 'num_workers': 4}, 'evaluation': {'interval': 1}, 'checkpoint': {'interval': 5}, 'log': {'interval': 50}}
[2025-09-19 20:52:48,804 INFO train.py line 34 98867] 使用设备: cuda
[2025-09-19 20:52:49,463 ERROR train.py line 56 98867] 打印第一个batch失败: Caught UnboundLocalError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/home/wai/miniconda3/envs/pct/lib/python3.8/site-packages/torch/utils/data/_utils/worker.py", line 308, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/wai/miniconda3/envs/pct/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 51, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/wai/miniconda3/envs/pct/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 51, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/wai/PointTransformerV3/pointcept/datasets/wind_shear.py", line 162, in __getitem__
    data_dict = self.transform(data_dict)
  File "/home/wai/miniconda3/envs/pct/lib/python3.8/site-packages/torchvision/transforms/transforms.py", line 95, in __call__
    img = t(img)
  File "/home/wai/PointTransformerV3/pointcept/datasets/transforms/wind_shear.py", line 88, in __call__
    grid_idx = np.floor((coord - [x_min, y_min, z_min]) / [grid_size_x, grid_size_y, grid_size_z]).astype(int)
UnboundLocalError: local variable 'x_min' referenced before assignment

[2025-09-19 20:52:49,463 INFO train.py line 58 98867] 训练集样本数: 8935, 验证集样本数: 2130
[2025-09-19 20:52:49,930 INFO train.py line 64 98867] 模型类型: PointTransformerV3
[2025-09-19 20:52:49,932 INFO train.py line 88 98867] 
===== Epoch 1/100 =====
[2025-09-19 21:18:26,353 INFO train.py line 29 103878] 使用配置文件: configs/wind_shear/pointtransformer_v3.yaml
[2025-09-19 21:18:26,353 INFO train.py line 30 103878] 配置详情: {'model': {'type': 'PT-v3m1', 'in_channels': 9, 'num_classes': 2, 'cls_mode': False, 'order': ['z', 'z-trans'], 'pdnorm_bn': False, 'pdnorm_ln': False, 'enc_depths': [2, 2, 6, 2], 'enc_channels': [32, 64, 128, 256], 'enc_num_head': [2, 4, 8, 16], 'stride': [2, 2, 2], 'enc_patch_size': [48, 48, 48, 48], 'dec_depths': [2, 2, 2], 'dec_channels': [64, 64, 128], 'dec_num_head': [4, 4, 8], 'dec_patch_size': [48, 48, 48], 'mlp_ratio': 4, 'qkv_bias': True, 'drop_path': 0.3, 'enable_flash': False}, 'data': {'train': {'type': 'WindShearDataset', 'split': 'train', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': [122.6, 118.0, 5.4], 'min_points': 50, 'adaptive': False}, {'type': 'ToTensor'}]}, 'val': {'type': 'WindShearDataset', 'split': 'val', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': [122.6, 118.0, 5.4], 'min_points': 50, 'adaptive': False}, {'type': 'ToTensor'}]}, 'test': {'type': 'WindShearDataset', 'split': 'test', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': [122.6, 118.0, 5.4], 'min_points': 50, 'adaptive': False}, {'type': 'ToTensor'}]}}, 'train': {'epochs': 100, 'optimizer': {'type': 'AdamW', 'lr': 0.001, 'weight_decay': 0.0001}, 'scheduler': {'type': 'CosineAnnealingLR', 'T_max': 100}, 'batch_size': 2, 'num_workers': 4}, 'evaluation': {'interval': 1}, 'checkpoint': {'interval': 5}, 'log': {'interval': 50}}
[2025-09-19 21:18:26,539 INFO train.py line 34 103878] 使用设备: cuda
[2025-09-19 21:18:27,397 ERROR train.py line 56 103878] 打印第一个batch失败: Caught AttributeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/home/wai/miniconda3/envs/pct/lib/python3.8/site-packages/torch/utils/data/_utils/worker.py", line 308, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/wai/miniconda3/envs/pct/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 51, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/wai/miniconda3/envs/pct/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 51, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/wai/PointTransformerV3/pointcept/datasets/wind_shear.py", line 166, in __getitem__
    if sampled_num < self.min_points:  # 这里的self.min_points需要从配置中获取
AttributeError: 'WindShearDataset' object has no attribute 'min_points'

[2025-09-19 21:18:27,397 INFO train.py line 58 103878] 训练集样本数: 8935, 验证集样本数: 2130
[2025-09-19 21:18:27,811 INFO train.py line 64 103878] 模型类型: PointTransformerV3
[2025-09-19 21:18:27,812 INFO train.py line 88 103878] 
===== Epoch 1/100 =====
[2025-09-19 21:23:16,176 INFO train.py line 29 104894] 使用配置文件: configs/wind_shear/pointtransformer_v3.yaml
[2025-09-19 21:23:16,177 INFO train.py line 30 104894] 配置详情: {'model': {'type': 'PT-v3m1', 'in_channels': 9, 'num_classes': 2, 'cls_mode': False, 'order': ['z', 'z-trans'], 'pdnorm_bn': False, 'pdnorm_ln': False, 'enc_depths': [2, 2, 6, 2], 'enc_channels': [32, 64, 128, 256], 'enc_num_head': [2, 4, 8, 16], 'stride': [2, 2, 2], 'enc_patch_size': [48, 48, 48, 48], 'dec_depths': [2, 2, 2], 'dec_channels': [64, 64, 128], 'dec_num_head': [4, 4, 8], 'dec_patch_size': [48, 48, 48], 'mlp_ratio': 4, 'qkv_bias': True, 'drop_path': 0.3, 'enable_flash': False}, 'data': {'train': {'type': 'WindShearDataset', 'split': 'train', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': [122.6, 118.0, 5.4], 'min_points': 50, 'adaptive': False}, {'type': 'ToTensor'}]}, 'val': {'type': 'WindShearDataset', 'split': 'val', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': [122.6, 118.0, 5.4], 'min_points': 50, 'adaptive': False}, {'type': 'ToTensor'}]}, 'test': {'type': 'WindShearDataset', 'split': 'test', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': [122.6, 118.0, 5.4], 'min_points': 50, 'adaptive': False}, {'type': 'ToTensor'}]}}, 'train': {'epochs': 100, 'optimizer': {'type': 'AdamW', 'lr': 0.001, 'weight_decay': 0.0001}, 'scheduler': {'type': 'CosineAnnealingLR', 'T_max': 100}, 'batch_size': 2, 'num_workers': 4}, 'evaluation': {'interval': 1}, 'checkpoint': {'interval': 5}, 'log': {'interval': 50}}
[2025-09-19 21:23:16,363 INFO train.py line 34 104894] 使用设备: cuda
[2025-09-19 21:23:17,251 INFO train.py line 49 104894] First batch structure (验证collate_fn输出):
[2025-09-19 21:23:17,251 INFO train.py line 52 104894]   offset: shape torch.Size([3]), dtype torch.int64
[2025-09-19 21:23:17,251 INFO train.py line 52 104894]   coord: shape torch.Size([4224, 3]), dtype torch.float32
[2025-09-19 21:23:17,251 INFO train.py line 52 104894]   feat: shape torch.Size([4224, 9]), dtype torch.float32
[2025-09-19 21:23:17,251 INFO train.py line 52 104894]   label: shape torch.Size([4224]), dtype torch.int64
[2025-09-19 21:23:17,251 INFO train.py line 52 104894]   beamaz: shape torch.Size([4224]), dtype torch.float32
[2025-09-19 21:23:17,251 INFO train.py line 52 104894]   grid_size: shape torch.Size([3]), dtype torch.float32
[2025-09-19 21:23:17,251 INFO train.py line 54 104894]   path: type <class 'list'>
[2025-09-19 21:23:17,251 INFO train.py line 58 104894] 训练集样本数: 8935, 验证集样本数: 2130
[2025-09-19 21:23:17,535 INFO train.py line 64 104894] 模型类型: PointTransformerV3
[2025-09-19 21:23:17,536 INFO train.py line 88 104894] 
===== Epoch 1/100 =====
[2025-09-19 21:26:38,459 INFO train.py line 29 105638] 使用配置文件: configs/wind_shear/pointtransformer_v3.yaml
[2025-09-19 21:26:38,460 INFO train.py line 30 105638] 配置详情: {'model': {'type': 'PT-v3m1', 'in_channels': 9, 'num_classes': 2, 'cls_mode': False, 'order': ['z', 'z-trans'], 'pdnorm_bn': False, 'pdnorm_ln': False, 'enc_depths': [2, 2, 6, 2], 'enc_channels': [32, 64, 128, 256], 'enc_num_head': [2, 4, 8, 16], 'stride': [2, 2, 2], 'enc_patch_size': [48, 48, 48, 48], 'dec_depths': [2, 2, 2], 'dec_channels': [64, 64, 128], 'dec_num_head': [4, 4, 8], 'dec_patch_size': [48, 48, 48], 'mlp_ratio': 4, 'qkv_bias': True, 'drop_path': 0.3, 'enable_flash': False}, 'data': {'train': {'type': 'WindShearDataset', 'split': 'train', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': [122.6, 118.0, 5.4], 'min_points': 50, 'adaptive': False}, {'type': 'ToTensor'}]}, 'val': {'type': 'WindShearDataset', 'split': 'val', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': [122.6, 118.0, 5.4], 'min_points': 50, 'adaptive': False}, {'type': 'ToTensor'}]}, 'test': {'type': 'WindShearDataset', 'split': 'test', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': [122.6, 118.0, 5.4], 'min_points': 50, 'adaptive': False}, {'type': 'ToTensor'}]}}, 'train': {'epochs': 100, 'optimizer': {'type': 'AdamW', 'lr': 0.001, 'weight_decay': 0.0001}, 'scheduler': {'type': 'CosineAnnealingLR', 'T_max': 100}, 'batch_size': 2, 'num_workers': 4}, 'evaluation': {'interval': 1}, 'checkpoint': {'interval': 5}, 'log': {'interval': 50}}
[2025-09-19 21:26:38,703 INFO train.py line 34 105638] 使用设备: cuda
[2025-09-19 21:26:39,826 INFO train.py line 49 105638] First batch structure (验证collate_fn输出):
[2025-09-19 21:26:39,826 INFO train.py line 52 105638]   offset: shape torch.Size([3]), dtype torch.int64
[2025-09-19 21:26:39,826 INFO train.py line 52 105638]   coord: shape torch.Size([8064, 3]), dtype torch.float32
[2025-09-19 21:26:39,826 INFO train.py line 52 105638]   feat: shape torch.Size([8064, 9]), dtype torch.float32
[2025-09-19 21:26:39,827 INFO train.py line 52 105638]   label: shape torch.Size([8064]), dtype torch.int64
[2025-09-19 21:26:39,827 INFO train.py line 52 105638]   beamaz: shape torch.Size([8064]), dtype torch.float32
[2025-09-19 21:26:39,827 INFO train.py line 52 105638]   grid_size: shape torch.Size([3]), dtype torch.float32
[2025-09-19 21:26:39,827 INFO train.py line 54 105638]   path: type <class 'list'>
[2025-09-19 21:26:39,827 INFO train.py line 58 105638] 训练集样本数: 8935, 验证集样本数: 2130
[2025-09-19 21:26:40,143 INFO train.py line 64 105638] 模型类型: PointTransformerV3
[2025-09-19 21:26:40,145 INFO train.py line 88 105638] 
===== Epoch 1/100 =====
[2025-09-19 21:34:14,239 INFO train.py line 29 107250] 使用配置文件: configs/wind_shear/pointtransformer_v3.yaml
[2025-09-19 21:34:14,239 INFO train.py line 30 107250] 配置详情: {'model': {'type': 'PT-v3m1', 'in_channels': 9, 'num_classes': 2, 'cls_mode': False, 'order': ['z', 'z-trans'], 'pdnorm_bn': False, 'pdnorm_ln': False, 'enc_depths': [2, 2, 6, 2], 'enc_channels': [32, 64, 128, 256], 'enc_num_head': [2, 4, 8, 16], 'stride': [2, 2, 2], 'enc_patch_size': [48, 48, 48, 48], 'dec_depths': [2, 2, 2], 'dec_channels': [64, 64, 128], 'dec_num_head': [4, 4, 8], 'dec_patch_size': [48, 48, 48], 'mlp_ratio': 4, 'qkv_bias': True, 'drop_path': 0.3, 'enable_flash': False}, 'data': {'train': {'type': 'WindShearDataset', 'split': 'train', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': [122.6, 118.0, 5.4], 'min_points': 50, 'adaptive': False}, {'type': 'ToTensor'}]}, 'val': {'type': 'WindShearDataset', 'split': 'val', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': [122.6, 118.0, 5.4], 'min_points': 50, 'adaptive': False}, {'type': 'ToTensor'}]}, 'test': {'type': 'WindShearDataset', 'split': 'test', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': [122.6, 118.0, 5.4], 'min_points': 50, 'adaptive': False}, {'type': 'ToTensor'}]}}, 'train': {'epochs': 100, 'optimizer': {'type': 'AdamW', 'lr': 0.001, 'weight_decay': 0.0001}, 'scheduler': {'type': 'CosineAnnealingLR', 'T_max': 100}, 'batch_size': 1, 'num_workers': 4}, 'evaluation': {'interval': 1}, 'checkpoint': {'interval': 5}, 'log': {'interval': 50}}
[2025-09-19 21:34:14,514 INFO train.py line 34 107250] 使用设备: cuda
[2025-09-19 21:34:15,461 INFO train.py line 49 107250] First batch structure (验证collate_fn输出):
[2025-09-19 21:34:15,461 INFO train.py line 52 107250]   offset: shape torch.Size([2]), dtype torch.int64
[2025-09-19 21:34:15,461 INFO train.py line 52 107250]   coord: shape torch.Size([4224, 3]), dtype torch.float32
[2025-09-19 21:34:15,461 INFO train.py line 52 107250]   feat: shape torch.Size([4224, 9]), dtype torch.float32
[2025-09-19 21:34:15,461 INFO train.py line 52 107250]   label: shape torch.Size([4224]), dtype torch.int64
[2025-09-19 21:34:15,461 INFO train.py line 52 107250]   beamaz: shape torch.Size([4224]), dtype torch.float32
[2025-09-19 21:34:15,461 INFO train.py line 52 107250]   grid_size: shape torch.Size([3]), dtype torch.float32
[2025-09-19 21:34:15,461 INFO train.py line 54 107250]   path: type <class 'list'>
[2025-09-19 21:34:15,462 INFO train.py line 58 107250] 训练集样本数: 8935, 验证集样本数: 2130
[2025-09-19 21:34:15,726 INFO train.py line 64 107250] 模型类型: PointTransformerV3
[2025-09-19 21:34:15,728 INFO train.py line 88 107250] 
===== Epoch 1/100 =====
[2025-09-19 21:38:54,162 INFO train.py line 29 108116] 使用配置文件: configs/wind_shear/pointtransformer_v3.yaml
[2025-09-19 21:38:54,162 INFO train.py line 30 108116] 配置详情: {'model': {'type': 'PT-v3m1', 'in_channels': 9, 'num_classes': 2, 'cls_mode': False, 'order': ['z', 'z-trans'], 'pdnorm_bn': False, 'pdnorm_ln': False, 'enc_depths': [2, 2, 6, 2], 'enc_channels': [32, 64, 128, 256], 'enc_num_head': [2, 4, 8, 16], 'stride': [2, 2, 2], 'enc_patch_size': [48, 48, 48, 48], 'dec_depths': [2, 2, 2], 'dec_channels': [64, 64, 128], 'dec_num_head': [4, 4, 8], 'dec_patch_size': [48, 48, 48], 'mlp_ratio': 4, 'qkv_bias': True, 'drop_path': 0.3, 'enable_flash': False}, 'data': {'train': {'type': 'WindShearDataset', 'split': 'train', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': [122.6, 118.0, 5.4], 'min_points': 50, 'adaptive': False}, {'type': 'ToTensor'}]}, 'val': {'type': 'WindShearDataset', 'split': 'val', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': [122.6, 118.0, 5.4], 'min_points': 50, 'adaptive': False}, {'type': 'ToTensor'}]}, 'test': {'type': 'WindShearDataset', 'split': 'test', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': [122.6, 118.0, 5.4], 'min_points': 50, 'adaptive': False}, {'type': 'ToTensor'}]}}, 'train': {'epochs': 100, 'optimizer': {'type': 'AdamW', 'lr': 0.001, 'weight_decay': 0.0001}, 'scheduler': {'type': 'CosineAnnealingLR', 'T_max': 100}, 'batch_size': 2, 'num_workers': 4}, 'evaluation': {'interval': 1}, 'checkpoint': {'interval': 5}, 'log': {'interval': 50}}
[2025-09-19 21:38:54,327 INFO train.py line 34 108116] 使用设备: cuda
[2025-09-19 21:38:55,342 INFO train.py line 49 108116] First batch structure (验证collate_fn输出):
[2025-09-19 21:38:55,343 INFO train.py line 52 108116]   offset: shape torch.Size([3]), dtype torch.int64
[2025-09-19 21:38:55,343 INFO train.py line 52 108116]   coord: shape torch.Size([8448, 3]), dtype torch.float32
[2025-09-19 21:38:55,343 INFO train.py line 52 108116]   feat: shape torch.Size([8448, 9]), dtype torch.float32
[2025-09-19 21:38:55,343 INFO train.py line 52 108116]   label: shape torch.Size([8448]), dtype torch.int64
[2025-09-19 21:38:55,343 INFO train.py line 52 108116]   beamaz: shape torch.Size([8448]), dtype torch.float32
[2025-09-19 21:38:55,343 INFO train.py line 52 108116]   grid_size: shape torch.Size([3]), dtype torch.float32
[2025-09-19 21:38:55,343 INFO train.py line 54 108116]   path: type <class 'list'>
[2025-09-19 21:38:55,343 INFO train.py line 58 108116] 训练集样本数: 8935, 验证集样本数: 2130
[2025-09-19 21:38:55,611 INFO train.py line 64 108116] 模型类型: PointTransformerV3
[2025-09-19 21:38:55,612 INFO train.py line 88 108116] 
===== Epoch 1/100 =====
[2025-09-20 00:28:38,153 INFO train.py line 29 2829] 使用配置文件: configs/wind_shear/pointtransformer_v3.yaml
[2025-09-20 00:28:38,154 INFO train.py line 30 2829] 配置详情: {'model': {'type': 'PT-v3m1', 'in_channels': 9, 'num_classes': 2, 'cls_mode': False, 'order': ['z', 'z-trans'], 'pdnorm_bn': False, 'pdnorm_ln': False, 'enc_depths': [2, 2, 6, 2], 'enc_channels': [32, 64, 128, 256], 'enc_num_head': [2, 4, 8, 16], 'stride': [2, 2, 2], 'enc_patch_size': [48, 48, 48, 48], 'dec_depths': [2, 2, 2], 'dec_channels': [64, 64, 128], 'dec_num_head': [4, 4, 8], 'dec_patch_size': [48, 48, 48], 'mlp_ratio': 4, 'qkv_bias': True, 'drop_path': 0.3, 'enable_flash': False}, 'data': {'train': {'type': 'WindShearDataset', 'split': 'train', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': [122.6, 118.0, 5.4], 'min_points': 50, 'adaptive': False}, {'type': 'ToTensor'}]}, 'val': {'type': 'WindShearDataset', 'split': 'val', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': [122.6, 118.0, 5.4], 'min_points': 50, 'adaptive': False}, {'type': 'ToTensor'}]}, 'test': {'type': 'WindShearDataset', 'split': 'test', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': [122.6, 118.0, 5.4], 'min_points': 50, 'adaptive': False}, {'type': 'ToTensor'}]}}, 'train': {'epochs': 100, 'optimizer': {'type': 'AdamW', 'lr': 0.001, 'weight_decay': 0.0001}, 'scheduler': {'type': 'CosineAnnealingLR', 'T_max': 100}, 'batch_size': 2, 'num_workers': 4}, 'evaluation': {'interval': 1}, 'checkpoint': {'interval': 5}, 'log': {'interval': 50}}
[2025-09-20 00:28:38,575 INFO train.py line 34 2829] 使用设备: cuda
[2025-09-20 00:28:40,718 INFO train.py line 49 2829] First batch structure (验证collate_fn输出):
[2025-09-20 00:28:40,719 INFO train.py line 52 2829]   offset: shape torch.Size([3]), dtype torch.int64
[2025-09-20 00:28:40,719 INFO train.py line 52 2829]   coord: shape torch.Size([9984, 3]), dtype torch.float32
[2025-09-20 00:28:40,719 INFO train.py line 52 2829]   feat: shape torch.Size([9984, 9]), dtype torch.float32
[2025-09-20 00:28:40,719 INFO train.py line 52 2829]   label: shape torch.Size([9984]), dtype torch.int64
[2025-09-20 00:28:40,719 INFO train.py line 52 2829]   beamaz: shape torch.Size([9984]), dtype torch.float32
[2025-09-20 00:28:40,719 INFO train.py line 52 2829]   grid_size: shape torch.Size([3]), dtype torch.float32
[2025-09-20 00:28:40,719 INFO train.py line 54 2829]   path: type <class 'list'>
[2025-09-20 00:28:40,719 INFO train.py line 58 2829] 训练集样本数: 8935, 验证集样本数: 2130
[2025-09-20 00:28:41,083 INFO train.py line 64 2829] 模型类型: PointTransformerV3
[2025-09-20 00:28:41,084 INFO train.py line 88 2829] 
===== Epoch 1/100 =====
[2025-09-20 01:17:52,727 INFO train.py line 29 12674] 使用配置文件: configs/wind_shear/pointtransformer_v3.yaml
[2025-09-20 01:17:52,728 INFO train.py line 30 12674] 配置详情: {'model': {'type': 'PT-v3m1', 'in_channels': 9, 'num_classes': 2, 'cls_mode': False, 'order': ['z', 'z-trans'], 'pdnorm_bn': False, 'pdnorm_ln': False, 'enc_depths': [2, 2, 6, 2], 'enc_channels': [32, 64, 128, 256], 'enc_num_head': [2, 4, 8, 16], 'stride': [2, 2, 2], 'enc_patch_size': [48, 48, 48, 48], 'dec_depths': [2, 2, 2], 'dec_channels': [64, 64, 128], 'dec_num_head': [4, 4, 8], 'dec_patch_size': [48, 48, 48], 'mlp_ratio': 4, 'qkv_bias': True, 'drop_path': 0.3, 'enable_flash': False}, 'data': {'train': {'type': 'WindShearDataset', 'split': 'train', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': [122.6, 118.0, 5.4], 'min_points': 50, 'adaptive': False}, {'type': 'ToTensor'}]}, 'val': {'type': 'WindShearDataset', 'split': 'val', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': [122.6, 118.0, 5.4], 'min_points': 50, 'adaptive': False}, {'type': 'ToTensor'}]}, 'test': {'type': 'WindShearDataset', 'split': 'test', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': [122.6, 118.0, 5.4], 'min_points': 50, 'adaptive': False}, {'type': 'ToTensor'}]}}, 'train': {'epochs': 100, 'optimizer': {'type': 'AdamW', 'lr': 0.001, 'weight_decay': 0.0001}, 'scheduler': {'type': 'CosineAnnealingLR', 'T_max': 100}, 'batch_size': 2, 'num_workers': 4}, 'evaluation': {'interval': 1}, 'checkpoint': {'interval': 5}, 'log': {'interval': 50}}
[2025-09-20 01:17:53,012 INFO train.py line 34 12674] 使用设备: cuda
[2025-09-20 01:17:54,270 INFO train.py line 49 12674] First batch structure (验证collate_fn输出):
[2025-09-20 01:17:54,271 INFO train.py line 52 12674]   offset: shape torch.Size([3]), dtype torch.int64
[2025-09-20 01:17:54,272 INFO train.py line 52 12674]   coord: shape torch.Size([7680, 3]), dtype torch.float32
[2025-09-20 01:17:54,272 INFO train.py line 52 12674]   feat: shape torch.Size([7680, 9]), dtype torch.float32
[2025-09-20 01:17:54,272 INFO train.py line 52 12674]   label: shape torch.Size([7680]), dtype torch.int64
[2025-09-20 01:17:54,272 INFO train.py line 52 12674]   beamaz: shape torch.Size([7680]), dtype torch.float32
[2025-09-20 01:17:54,272 INFO train.py line 52 12674]   grid_size: shape torch.Size([3]), dtype torch.float32
[2025-09-20 01:17:54,272 INFO train.py line 54 12674]   path: type <class 'list'>
[2025-09-20 01:17:54,272 INFO train.py line 58 12674] 训练集样本数: 8935, 验证集样本数: 2130
[2025-09-20 01:17:54,526 INFO train.py line 64 12674] 模型类型: PointTransformerV3
[2025-09-20 01:17:54,527 INFO train.py line 88 12674] 
===== Epoch 1/100 =====
[2025-09-20 01:21:03,233 INFO train.py line 29 13406] 使用配置文件: configs/wind_shear/pointtransformer_v3.yaml
[2025-09-20 01:21:03,234 INFO train.py line 30 13406] 配置详情: {'model': {'type': 'PT-v3m1', 'in_channels': 9, 'num_classes': 2, 'cls_mode': False, 'order': ['z', 'z-trans'], 'pdnorm_bn': False, 'pdnorm_ln': False, 'enc_depths': [2, 2, 6, 2], 'enc_channels': [32, 64, 128, 256], 'enc_num_head': [2, 4, 8, 16], 'stride': [2, 2, 2], 'enc_patch_size': [48, 48, 48, 48], 'dec_depths': [2, 2, 2], 'dec_channels': [64, 64, 128], 'dec_num_head': [4, 4, 8], 'dec_patch_size': [48, 48, 48], 'mlp_ratio': 4, 'qkv_bias': True, 'drop_path': 0.3, 'enable_flash': False}, 'data': {'train': {'type': 'WindShearDataset', 'split': 'train', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': [122.6, 118.0, 5.4], 'min_points': 50, 'adaptive': False}, {'type': 'ToTensor'}]}, 'val': {'type': 'WindShearDataset', 'split': 'val', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': [122.6, 118.0, 5.4], 'min_points': 50, 'adaptive': False}, {'type': 'ToTensor'}]}, 'test': {'type': 'WindShearDataset', 'split': 'test', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': [122.6, 118.0, 5.4], 'min_points': 50, 'adaptive': False}, {'type': 'ToTensor'}]}}, 'train': {'epochs': 100, 'optimizer': {'type': 'AdamW', 'lr': 0.001, 'weight_decay': 0.0001}, 'scheduler': {'type': 'CosineAnnealingLR', 'T_max': 100}, 'batch_size': 2, 'num_workers': 4}, 'evaluation': {'interval': 1}, 'checkpoint': {'interval': 5}, 'log': {'interval': 50}}
[2025-09-20 01:21:03,404 INFO train.py line 34 13406] 使用设备: cuda
[2025-09-20 01:21:04,295 INFO train.py line 49 13406] First batch structure (验证collate_fn输出):
[2025-09-20 01:21:04,295 INFO train.py line 52 13406]   offset: shape torch.Size([3]), dtype torch.int64
[2025-09-20 01:21:04,295 INFO train.py line 52 13406]   coord: shape torch.Size([7680, 3]), dtype torch.float32
[2025-09-20 01:21:04,295 INFO train.py line 52 13406]   feat: shape torch.Size([7680, 9]), dtype torch.float32
[2025-09-20 01:21:04,295 INFO train.py line 52 13406]   label: shape torch.Size([7680]), dtype torch.int64
[2025-09-20 01:21:04,295 INFO train.py line 52 13406]   beamaz: shape torch.Size([7680]), dtype torch.float32
[2025-09-20 01:21:04,295 INFO train.py line 52 13406]   grid_size: shape torch.Size([3]), dtype torch.float32
[2025-09-20 01:21:04,295 INFO train.py line 54 13406]   path: type <class 'list'>
[2025-09-20 01:21:04,295 INFO train.py line 58 13406] 训练集样本数: 8935, 验证集样本数: 2130
[2025-09-20 01:21:04,535 INFO train.py line 64 13406] 模型类型: PointTransformerV3
[2025-09-20 01:21:04,537 INFO train.py line 88 13406] 
===== Epoch 1/100 =====
[2025-09-20 01:29:05,332 INFO train.py line 29 15090] 使用配置文件: configs/wind_shear/pointtransformer_v3.yaml
[2025-09-20 01:29:05,332 INFO train.py line 30 15090] 配置详情: {'model': {'type': 'PT-v3m1', 'in_channels': 9, 'num_classes': 2, 'cls_mode': False, 'order': ['z', 'z-trans'], 'pdnorm_bn': False, 'pdnorm_ln': False, 'enc_depths': [2, 2, 6, 2], 'enc_channels': [32, 64, 128, 256], 'enc_num_head': [2, 4, 8, 16], 'stride': [2, 2, 2], 'enc_patch_size': [48, 48, 48, 48], 'dec_depths': [2, 2, 2], 'dec_channels': [64, 64, 128], 'dec_num_head': [4, 4, 8], 'dec_patch_size': [48, 48, 48], 'mlp_ratio': 4, 'qkv_bias': True, 'drop_path': 0.3, 'enable_flash': False}, 'data': {'train': {'type': 'WindShearDataset', 'split': 'train', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': [122.6, 118.0, 5.4], 'min_points': 50, 'adaptive': False}, {'type': 'ToTensor'}]}, 'val': {'type': 'WindShearDataset', 'split': 'val', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': [122.6, 118.0, 5.4], 'min_points': 50, 'adaptive': False}, {'type': 'ToTensor'}]}, 'test': {'type': 'WindShearDataset', 'split': 'test', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': [122.6, 118.0, 5.4], 'min_points': 50, 'adaptive': False}, {'type': 'ToTensor'}]}}, 'train': {'epochs': 100, 'optimizer': {'type': 'AdamW', 'lr': 0.001, 'weight_decay': 0.0001}, 'scheduler': {'type': 'CosineAnnealingLR', 'T_max': 100}, 'batch_size': 2, 'num_workers': 4}, 'evaluation': {'interval': 1}, 'checkpoint': {'interval': 5}, 'log': {'interval': 50}}
[2025-09-20 01:29:05,496 INFO train.py line 34 15090] 使用设备: cuda
[2025-09-20 01:29:06,408 INFO train.py line 49 15090] First batch structure (验证collate_fn输出):
[2025-09-20 01:29:06,409 INFO train.py line 52 15090]   offset: shape torch.Size([3]), dtype torch.int64
[2025-09-20 01:29:06,409 INFO train.py line 52 15090]   coord: shape torch.Size([8832, 3]), dtype torch.float32
[2025-09-20 01:29:06,409 INFO train.py line 52 15090]   feat: shape torch.Size([8832, 9]), dtype torch.float32
[2025-09-20 01:29:06,409 INFO train.py line 52 15090]   label: shape torch.Size([8832]), dtype torch.int64
[2025-09-20 01:29:06,409 INFO train.py line 52 15090]   beamaz: shape torch.Size([8832]), dtype torch.float32
[2025-09-20 01:29:06,409 INFO train.py line 52 15090]   grid_size: shape torch.Size([3]), dtype torch.float32
[2025-09-20 01:29:06,409 INFO train.py line 54 15090]   path: type <class 'list'>
[2025-09-20 01:29:06,409 INFO train.py line 58 15090] 训练集样本数: 8935, 验证集样本数: 2130
[2025-09-20 01:29:06,648 INFO train.py line 64 15090] 模型类型: PointTransformerV3
[2025-09-20 01:29:06,650 INFO train.py line 88 15090] 
===== Epoch 1/100 =====
[2025-09-20 13:41:35,620 INFO train.py line 29 25300] 使用配置文件: configs/wind_shear/pointtransformer_v3.yaml
[2025-09-20 13:41:35,621 INFO train.py line 30 25300] 配置详情: {'model': {'type': 'PT-v3m1', 'in_channels': 9, 'num_classes': 2, 'cls_mode': False, 'order': ['z', 'z-trans'], 'pdnorm_bn': False, 'pdnorm_ln': False, 'enc_depths': [2, 2, 6, 2], 'enc_channels': [32, 64, 128, 256], 'enc_num_head': [2, 4, 8, 16], 'stride': [2, 2, 2], 'enc_patch_size': [48, 48, 48, 48], 'dec_depths': [2, 2, 2], 'dec_channels': [64, 64, 128], 'dec_num_head': [4, 4, 8], 'dec_patch_size': [48, 48, 48], 'mlp_ratio': 4, 'qkv_bias': True, 'drop_path': 0.3, 'enable_flash': False}, 'data': {'train': {'type': 'WindShearDataset', 'split': 'train', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': [122.6, 118.0, 5.4], 'min_points': 50, 'adaptive': False}, {'type': 'ToTensor'}]}, 'val': {'type': 'WindShearDataset', 'split': 'val', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': [122.6, 118.0, 5.4], 'min_points': 50, 'adaptive': False}, {'type': 'ToTensor'}]}, 'test': {'type': 'WindShearDataset', 'split': 'test', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': [122.6, 118.0, 5.4], 'min_points': 50, 'adaptive': False}, {'type': 'ToTensor'}]}}, 'train': {'epochs': 100, 'optimizer': {'type': 'AdamW', 'lr': 0.001, 'weight_decay': 0.0001}, 'scheduler': {'type': 'CosineAnnealingLR', 'T_max': 100}, 'batch_size': 2, 'num_workers': 4}, 'evaluation': {'interval': 1}, 'checkpoint': {'interval': 5}, 'log': {'interval': 50}}
[2025-09-20 13:41:35,973 INFO train.py line 34 25300] 使用设备: cuda
[2025-09-20 13:41:35,683 INFO train.py line 49 25300] First batch structure (验证collate_fn输出):
[2025-09-20 13:41:35,684 INFO train.py line 52 25300]   offset: shape torch.Size([3]), dtype torch.int64
[2025-09-20 13:41:35,684 INFO train.py line 52 25300]   coord: shape torch.Size([8064, 3]), dtype torch.float32
[2025-09-20 13:41:35,684 INFO train.py line 52 25300]   feat: shape torch.Size([8064, 9]), dtype torch.float32
[2025-09-20 13:41:35,684 INFO train.py line 52 25300]   label: shape torch.Size([8064]), dtype torch.int64
[2025-09-20 13:41:35,684 INFO train.py line 52 25300]   beamaz: shape torch.Size([8064]), dtype torch.float32
[2025-09-20 13:41:35,684 INFO train.py line 52 25300]   grid_size: shape torch.Size([3]), dtype torch.float32
[2025-09-20 13:41:35,685 INFO train.py line 54 25300]   path: type <class 'list'>
[2025-09-20 13:41:35,685 INFO train.py line 58 25300] 训练集样本数: 8935, 验证集样本数: 2130
[2025-09-20 13:41:35,981 INFO train.py line 64 25300] 模型类型: PointTransformerV3
[2025-09-20 13:41:35,983 INFO train.py line 88 25300] 
===== Epoch 1/100 =====
[2025-09-20 15:43:26,164 INFO train.py line 29 45795] 使用配置文件: configs/wind_shear/pointtransformer_v3.yaml
[2025-09-20 15:43:26,165 INFO train.py line 30 45795] 配置详情: {'model': {'type': 'PT-v3m1', 'in_channels': 9, 'num_classes': 2, 'cls_mode': False, 'order': ['z', 'z-trans'], 'pdnorm_bn': False, 'pdnorm_ln': False, 'enc_depths': [2, 2, 6, 2], 'enc_channels': [32, 64, 128, 256], 'enc_num_head': [2, 4, 8, 16], 'stride': [2, 2, 2], 'enc_patch_size': [48, 48, 48, 48], 'dec_depths': [2, 2, 2], 'dec_channels': [64, 64, 128], 'dec_num_head': [4, 4, 8], 'dec_patch_size': [48, 48, 48], 'mlp_ratio': 4, 'qkv_bias': True, 'drop_path': 0.3, 'enable_flash': False}, 'data': {'train': {'type': 'WindShearDataset', 'split': 'train', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': [122.6, 118.0, 5.4], 'min_points': 50, 'adaptive': False}, {'type': 'ToTensor'}]}, 'val': {'type': 'WindShearDataset', 'split': 'val', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': [122.6, 118.0, 5.4], 'min_points': 50, 'adaptive': False}, {'type': 'ToTensor'}]}, 'test': {'type': 'WindShearDataset', 'split': 'test', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': [122.6, 118.0, 5.4], 'min_points': 50, 'adaptive': False}, {'type': 'ToTensor'}]}}, 'train': {'epochs': 100, 'optimizer': {'type': 'AdamW', 'lr': 0.001, 'weight_decay': 0.0001}, 'scheduler': {'type': 'CosineAnnealingLR', 'T_max': 100}, 'batch_size': 2, 'num_workers': 4}, 'evaluation': {'interval': 1}, 'checkpoint': {'interval': 5}, 'log': {'interval': 50}}
[2025-09-20 15:43:26,505 INFO train.py line 34 45795] 使用设备: cuda
[2025-09-20 15:43:27,961 INFO train.py line 49 45795] First batch structure (验证collate_fn输出):
[2025-09-20 15:43:27,962 INFO train.py line 52 45795]   offset: shape torch.Size([3]), dtype torch.int64
[2025-09-20 15:43:27,962 INFO train.py line 52 45795]   coord: shape torch.Size([8832, 3]), dtype torch.float32
[2025-09-20 15:43:27,962 INFO train.py line 52 45795]   feat: shape torch.Size([8832, 9]), dtype torch.float32
[2025-09-20 15:43:27,962 INFO train.py line 52 45795]   label: shape torch.Size([8832]), dtype torch.int64
[2025-09-20 15:43:27,962 INFO train.py line 52 45795]   beamaz: shape torch.Size([8832]), dtype torch.float32
[2025-09-20 15:43:27,962 INFO train.py line 52 45795]   grid_size: shape torch.Size([3]), dtype torch.float32
[2025-09-20 15:43:27,962 INFO train.py line 54 45795]   path: type <class 'list'>
[2025-09-20 15:43:27,962 INFO train.py line 58 45795] 训练集样本数: 8935, 验证集样本数: 2130
[2025-09-20 15:43:28,228 INFO train.py line 64 45795] 模型类型: PointTransformerV3
[2025-09-20 15:43:28,230 INFO train.py line 88 45795] 
===== Epoch 1/100 =====
[2025-09-20 16:43:45,768 INFO train.py line 29 56034] 使用配置文件: configs/wind_shear/pointtransformer_v3.yaml
[2025-09-20 16:43:45,768 INFO train.py line 30 56034] 配置详情: {'model': {'type': 'PT-v3m1', 'in_channels': 9, 'num_classes': 2, 'cls_mode': False, 'order': ['z', 'z-trans'], 'pdnorm_bn': False, 'pdnorm_ln': False, 'enc_depths': [2, 2, 6, 2], 'enc_channels': [32, 64, 128, 256], 'enc_num_head': [2, 4, 8, 16], 'stride': [2, 2, 2], 'enc_patch_size': [48, 48, 48, 48], 'dec_depths': [2, 2, 2], 'dec_channels': [64, 64, 128], 'dec_num_head': [4, 4, 8], 'dec_patch_size': [48, 48, 48], 'mlp_ratio': 4, 'qkv_bias': True, 'drop_path': 0.3, 'enable_flash': False}, 'data': {'train': {'type': 'WindShearDataset', 'split': 'train', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': [122.6, 118.0, 5.4], 'min_points': 50, 'adaptive': False}, {'type': 'ToTensor'}]}, 'val': {'type': 'WindShearDataset', 'split': 'val', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': [122.6, 118.0, 5.4], 'min_points': 50, 'adaptive': False}, {'type': 'ToTensor'}]}, 'test': {'type': 'WindShearDataset', 'split': 'test', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': [122.6, 118.0, 5.4], 'min_points': 50, 'adaptive': False}, {'type': 'ToTensor'}]}}, 'train': {'epochs': 100, 'optimizer': {'type': 'AdamW', 'lr': 0.001, 'weight_decay': 0.0001}, 'scheduler': {'type': 'CosineAnnealingLR', 'T_max': 100}, 'batch_size': 2, 'num_workers': 4}, 'evaluation': {'interval': 1}, 'checkpoint': {'interval': 5}, 'log': {'interval': 50}}
[2025-09-20 16:43:46,155 INFO train.py line 34 56034] 使用设备: cuda
[2025-09-20 16:43:47,574 INFO train.py line 49 56034] First batch structure (验证collate_fn输出):
[2025-09-20 16:43:47,574 INFO train.py line 52 56034]   offset: shape torch.Size([3]), dtype torch.int64
[2025-09-20 16:43:47,574 INFO train.py line 52 56034]   coord: shape torch.Size([8448, 3]), dtype torch.float32
[2025-09-20 16:43:47,575 INFO train.py line 52 56034]   feat: shape torch.Size([8448, 9]), dtype torch.float32
[2025-09-20 16:43:47,575 INFO train.py line 52 56034]   label: shape torch.Size([8448]), dtype torch.int64
[2025-09-20 16:43:47,575 INFO train.py line 52 56034]   beamaz: shape torch.Size([8448]), dtype torch.float32
[2025-09-20 16:43:47,575 INFO train.py line 52 56034]   grid_size: shape torch.Size([3]), dtype torch.float32
[2025-09-20 16:43:47,575 INFO train.py line 54 56034]   path: type <class 'list'>
[2025-09-20 16:43:47,575 INFO train.py line 58 56034] 训练集样本数: 8935, 验证集样本数: 2130
[2025-09-20 16:46:55,280 INFO train.py line 29 56655] 使用配置文件: configs/wind_shear/pointtransformer_v3.yaml
[2025-09-20 16:46:55,280 INFO train.py line 30 56655] 配置详情: {'model': {'type': 'PT-v3m1', 'in_channels': 9, 'num_classes': 2, 'cls_mode': False, 'order': ['z', 'z-trans'], 'pdnorm_bn': False, 'pdnorm_ln': False, 'enc_depths': [2, 2, 6, 2], 'enc_channels': [32, 64, 128, 256], 'enc_num_head': [2, 4, 8, 16], 'stride': [2, 2, 2], 'enc_patch_size': [48, 48, 48, 48], 'dec_depths': [2, 2, 2], 'dec_channels': [64, 64, 128], 'dec_num_head': [4, 4, 8], 'dec_patch_size': [48, 48, 48], 'mlp_ratio': 4, 'qkv_bias': True, 'drop_path': 0.3, 'enable_flash': False}, 'data': {'train': {'type': 'WindShearDataset', 'split': 'train', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': [122.6, 118.0, 5.4], 'min_points': 50, 'adaptive': False}, {'type': 'ToTensor'}]}, 'val': {'type': 'WindShearDataset', 'split': 'val', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': [122.6, 118.0, 5.4], 'min_points': 50, 'adaptive': False}, {'type': 'ToTensor'}]}, 'test': {'type': 'WindShearDataset', 'split': 'test', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': [122.6, 118.0, 5.4], 'min_points': 50, 'adaptive': False}, {'type': 'ToTensor'}]}}, 'train': {'epochs': 100, 'optimizer': {'type': 'AdamW', 'lr': 0.001, 'weight_decay': 0.0001}, 'scheduler': {'type': 'CosineAnnealingLR', 'T_max': 100}, 'batch_size': 2, 'num_workers': 4}, 'evaluation': {'interval': 1}, 'checkpoint': {'interval': 5}, 'log': {'interval': 50}}
[2025-09-20 16:46:55,544 INFO train.py line 34 56655] 使用设备: cuda
[2025-09-20 16:46:56,605 INFO train.py line 49 56655] First batch structure (验证collate_fn输出):
[2025-09-20 16:46:56,605 INFO train.py line 52 56655]   offset: shape torch.Size([3]), dtype torch.int64
[2025-09-20 16:46:56,606 INFO train.py line 52 56655]   coord: shape torch.Size([8832, 3]), dtype torch.float32
[2025-09-20 16:46:56,606 INFO train.py line 52 56655]   feat: shape torch.Size([8832, 9]), dtype torch.float32
[2025-09-20 16:46:56,606 INFO train.py line 52 56655]   label: shape torch.Size([8832]), dtype torch.int64
[2025-09-20 16:46:56,606 INFO train.py line 52 56655]   beamaz: shape torch.Size([8832]), dtype torch.float32
[2025-09-20 16:46:56,606 INFO train.py line 52 56655]   grid_size: shape torch.Size([3]), dtype torch.float32
[2025-09-20 16:46:56,606 INFO train.py line 54 56655]   path: type <class 'list'>
[2025-09-20 16:46:56,606 INFO train.py line 58 56655] 训练集样本数: 8935, 验证集样本数: 2130
[2025-09-20 16:46:56,919 INFO train.py line 64 56655] 模型类型: PointTransformerV3
[2025-09-20 16:46:56,921 INFO train.py line 88 56655] 
===== Epoch 1/100 =====
[2025-09-20 16:59:07,318 INFO train.py line 29 58813] 使用配置文件: configs/wind_shear/pointtransformer_v3.yaml
[2025-09-20 16:59:07,318 INFO train.py line 30 58813] 配置详情: {'model': {'type': 'PT-v3m1', 'in_channels': 9, 'num_classes': 2, 'cls_mode': False, 'order': ['z', 'z-trans'], 'pdnorm_bn': False, 'pdnorm_ln': False, 'enc_depths': [2, 2, 6, 2], 'enc_channels': [32, 64, 128, 256], 'enc_num_head': [2, 4, 8, 16], 'stride': [2, 2, 2], 'enc_patch_size': [48, 48, 48, 48], 'dec_depths': [2, 2, 2], 'dec_channels': [64, 64, 128], 'dec_num_head': [4, 4, 8], 'dec_patch_size': [48, 48, 48], 'mlp_ratio': 4, 'qkv_bias': True, 'drop_path': 0.3, 'enable_flash': False}, 'data': {'train': {'type': 'WindShearDataset', 'split': 'train', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': [122.6, 118.0, 5.4], 'min_points': 50, 'adaptive': False}, {'type': 'ToTensor'}]}, 'val': {'type': 'WindShearDataset', 'split': 'val', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': [122.6, 118.0, 5.4], 'min_points': 50, 'adaptive': False}, {'type': 'ToTensor'}]}, 'test': {'type': 'WindShearDataset', 'split': 'test', 'data_root': '/mnt/d/model/wind_datas/csv_labels', 'k_neighbors': 16, 'radius': 100.0, 'transform': [{'type': 'NormalizeWind', 'u_mean': -0.7983, 'u_std': 2.6732, 'v_mean': 2.0401, 'v_std': 3.1915, 'beamaz_mean': 184.0494, 'beamaz_std': 100.2158}, {'type': 'WindShearGridSample', 'grid_size': [122.6, 118.0, 5.4], 'min_points': 50, 'adaptive': False}, {'type': 'ToTensor'}]}}, 'train': {'epochs': 100, 'optimizer': {'type': 'AdamW', 'lr': 0.001, 'weight_decay': 0.0001}, 'scheduler': {'type': 'CosineAnnealingLR', 'T_max': 100}, 'batch_size': 2, 'num_workers': 4}, 'evaluation': {'interval': 1}, 'checkpoint': {'interval': 5}, 'log': {'interval': 50}}
[2025-09-20 16:59:07,498 INFO train.py line 34 58813] 使用设备: cuda
[2025-09-20 16:59:08,553 INFO train.py line 49 58813] First batch structure (验证collate_fn输出):
[2025-09-20 16:59:08,553 INFO train.py line 52 58813]   offset: shape torch.Size([3]), dtype torch.int64
[2025-09-20 16:59:08,554 INFO train.py line 52 58813]   coord: shape torch.Size([6144, 3]), dtype torch.float32
[2025-09-20 16:59:08,554 INFO train.py line 52 58813]   feat: shape torch.Size([6144, 9]), dtype torch.float32
[2025-09-20 16:59:08,554 INFO train.py line 52 58813]   label: shape torch.Size([6144]), dtype torch.int64
[2025-09-20 16:59:08,554 INFO train.py line 52 58813]   beamaz: shape torch.Size([6144]), dtype torch.float32
[2025-09-20 16:59:08,554 INFO train.py line 52 58813]   grid_size: shape torch.Size([3]), dtype torch.float32
[2025-09-20 16:59:08,554 INFO train.py line 54 58813]   path: type <class 'list'>
[2025-09-20 16:59:08,554 INFO train.py line 58 58813] 训练集样本数: 8935, 验证集样本数: 2130
[2025-09-20 16:59:08,877 INFO train.py line 64 58813] 模型类型: PointTransformerV3
[2025-09-20 16:59:08,879 INFO train.py line 88 58813] 
===== Epoch 1/100 =====
[2025-09-20 17:21:23,394 INFO train.py line 34 62701] 使用配置文件: configs/wind_shear/pointtransformer_v3.yaml
[2025-09-20 17:21:23,592 INFO train.py line 39 62701] 使用设备: cuda
[2025-09-20 17:21:24,943 INFO train.py line 54 62701] First batch structure (验证collate_fn输出):
[2025-09-20 17:21:24,943 INFO train.py line 57 62701]   offset: shape torch.Size([3]), dtype torch.int64
[2025-09-20 17:21:24,943 INFO train.py line 57 62701]   coord: shape torch.Size([10368, 3]), dtype torch.float32
[2025-09-20 17:21:24,943 INFO train.py line 57 62701]   feat: shape torch.Size([10368, 9]), dtype torch.float32
[2025-09-20 17:21:24,943 INFO train.py line 57 62701]   label: shape torch.Size([10368]), dtype torch.int64
[2025-09-20 17:21:24,943 INFO train.py line 57 62701]   beamaz: shape torch.Size([10368]), dtype torch.float32
[2025-09-20 17:21:24,943 INFO train.py line 57 62701]   grid_size: shape torch.Size([3]), dtype torch.float32
[2025-09-20 17:21:24,943 INFO train.py line 59 62701]   path: type <class 'list'>
[2025-09-20 17:21:24,944 INFO train.py line 63 62701] 训练集样本数: 8935, 验证集样本数: 2130
[2025-09-20 17:21:25,213 INFO train.py line 69 62701] 模型类型: PointTransformerV3
[2025-09-20 17:21:25,215 INFO train.py line 93 62701] 
===== Epoch 1/100 =====
[2025-09-20 17:23:51,453 INFO train.py line 34 63208] 使用配置文件: configs/wind_shear/pointtransformer_v3.yaml
[2025-09-20 17:23:51,754 INFO train.py line 39 63208] 使用设备: cuda
[2025-09-20 17:23:52,914 INFO train.py line 54 63208] First batch structure (验证collate_fn输出):
[2025-09-20 17:23:52,914 INFO train.py line 57 63208]   offset: shape torch.Size([3]), dtype torch.int64
[2025-09-20 17:23:52,915 INFO train.py line 57 63208]   coord: shape torch.Size([7680, 3]), dtype torch.float32
[2025-09-20 17:23:52,915 INFO train.py line 57 63208]   feat: shape torch.Size([7680, 9]), dtype torch.float32
[2025-09-20 17:23:52,915 INFO train.py line 57 63208]   label: shape torch.Size([7680]), dtype torch.int64
[2025-09-20 17:23:52,915 INFO train.py line 57 63208]   beamaz: shape torch.Size([7680]), dtype torch.float32
[2025-09-20 17:23:52,915 INFO train.py line 57 63208]   grid_size: shape torch.Size([3]), dtype torch.float32
[2025-09-20 17:23:52,916 INFO train.py line 59 63208]   path: type <class 'list'>
[2025-09-20 17:23:52,916 INFO train.py line 63 63208] 训练集样本数: 8935, 验证集样本数: 2130
[2025-09-20 17:23:53,184 INFO train.py line 69 63208] 模型类型: PointTransformerV3
[2025-09-20 17:23:53,185 INFO train.py line 93 63208] 
===== Epoch 1/100 =====
[2025-09-20 17:30:36,946 INFO train.py line 34 64490] 使用配置文件: configs/wind_shear/pointtransformer_v3.yaml
[2025-09-20 17:30:37,131 INFO train.py line 39 64490] 使用设备: cuda
[2025-09-20 17:30:38,114 INFO train.py line 54 64490] First batch structure (验证collate_fn输出):
[2025-09-20 17:30:38,115 INFO train.py line 57 64490]   offset: shape torch.Size([3]), dtype torch.int64
[2025-09-20 17:30:38,115 INFO train.py line 57 64490]   coord: shape torch.Size([7680, 3]), dtype torch.float32
[2025-09-20 17:30:38,115 INFO train.py line 57 64490]   feat: shape torch.Size([7680, 9]), dtype torch.float32
[2025-09-20 17:30:38,115 INFO train.py line 57 64490]   label: shape torch.Size([7680]), dtype torch.int64
[2025-09-20 17:30:38,115 INFO train.py line 57 64490]   beamaz: shape torch.Size([7680]), dtype torch.float32
[2025-09-20 17:30:38,115 INFO train.py line 57 64490]   grid_size: shape torch.Size([3]), dtype torch.float32
[2025-09-20 17:30:38,115 INFO train.py line 59 64490]   path: type <class 'list'>
[2025-09-20 17:30:38,116 INFO train.py line 63 64490] 训练集样本数: 8935, 验证集样本数: 2130
[2025-09-20 17:30:38,393 INFO train.py line 69 64490] 模型类型: PointTransformerV3
[2025-09-20 17:30:38,394 INFO train.py line 93 64490] 
===== Epoch 1/100 =====
[2025-09-20 17:32:40,288 INFO train.py line 34 64927] 使用配置文件: configs/wind_shear/pointtransformer_v3.yaml
[2025-09-20 17:32:40,504 INFO train.py line 39 64927] 使用设备: cuda
[2025-09-20 17:32:41,748 INFO train.py line 54 64927] First batch structure (验证collate_fn输出):
[2025-09-20 17:32:41,748 INFO train.py line 57 64927]   offset: shape torch.Size([3]), dtype torch.int64
[2025-09-20 17:32:41,748 INFO train.py line 57 64927]   coord: shape torch.Size([9984, 3]), dtype torch.float32
[2025-09-20 17:32:41,748 INFO train.py line 57 64927]   feat: shape torch.Size([9984, 9]), dtype torch.float32
[2025-09-20 17:32:41,748 INFO train.py line 57 64927]   label: shape torch.Size([9984]), dtype torch.int64
[2025-09-20 17:32:41,748 INFO train.py line 57 64927]   beamaz: shape torch.Size([9984]), dtype torch.float32
[2025-09-20 17:32:41,749 INFO train.py line 57 64927]   grid_size: shape torch.Size([3]), dtype torch.float32
[2025-09-20 17:32:41,749 INFO train.py line 59 64927]   path: type <class 'list'>
[2025-09-20 17:32:41,749 INFO train.py line 63 64927] 训练集样本数: 8935, 验证集样本数: 2130
[2025-09-20 17:32:42,001 INFO train.py line 69 64927] 模型类型: PointTransformerV3
[2025-09-20 17:32:42,002 INFO train.py line 93 64927] 
===== Epoch 1/100 =====
[2025-09-20 17:34:01,434 INFO train.py line 34 65242] 使用配置文件: configs/wind_shear/pointtransformer_v3.yaml
[2025-09-20 17:34:01,618 INFO train.py line 39 65242] 使用设备: cuda
[2025-09-20 17:34:02,577 INFO train.py line 54 65242] First batch structure (验证collate_fn输出):
[2025-09-20 17:34:02,577 INFO train.py line 57 65242]   offset: shape torch.Size([3]), dtype torch.int64
[2025-09-20 17:34:02,578 INFO train.py line 57 65242]   coord: shape torch.Size([7680, 3]), dtype torch.float32
[2025-09-20 17:34:02,578 INFO train.py line 57 65242]   feat: shape torch.Size([7680, 9]), dtype torch.float32
[2025-09-20 17:34:02,578 INFO train.py line 57 65242]   label: shape torch.Size([7680]), dtype torch.int64
[2025-09-20 17:34:02,578 INFO train.py line 57 65242]   beamaz: shape torch.Size([7680]), dtype torch.float32
[2025-09-20 17:34:02,578 INFO train.py line 57 65242]   grid_size: shape torch.Size([3]), dtype torch.float32
[2025-09-20 17:34:02,578 INFO train.py line 59 65242]   path: type <class 'list'>
[2025-09-20 17:34:02,578 INFO train.py line 63 65242] 训练集样本数: 8935, 验证集样本数: 2130
[2025-09-20 17:34:02,843 INFO train.py line 69 65242] 模型类型: PointTransformerV3
[2025-09-20 17:34:02,845 INFO train.py line 93 65242] 
===== Epoch 1/100 =====
[2025-09-20 17:36:20,499 INFO train.py line 34 65773] 使用配置文件: configs/wind_shear/pointtransformer_v3.yaml
[2025-09-20 17:36:20,697 INFO train.py line 39 65773] 使用设备: cuda
[2025-09-20 17:36:21,885 INFO train.py line 54 65773] First batch structure (验证collate_fn输出):
[2025-09-20 17:36:21,886 INFO train.py line 57 65773]   offset: shape torch.Size([3]), dtype torch.int64
[2025-09-20 17:36:21,886 INFO train.py line 57 65773]   coord: shape torch.Size([6528, 3]), dtype torch.float32
[2025-09-20 17:36:21,886 INFO train.py line 57 65773]   feat: shape torch.Size([6528, 9]), dtype torch.float32
[2025-09-20 17:36:21,886 INFO train.py line 57 65773]   label: shape torch.Size([6528]), dtype torch.int64
[2025-09-20 17:36:21,886 INFO train.py line 57 65773]   beamaz: shape torch.Size([6528]), dtype torch.float32
[2025-09-20 17:36:21,886 INFO train.py line 57 65773]   grid_size: shape torch.Size([3]), dtype torch.float32
[2025-09-20 17:36:21,886 INFO train.py line 59 65773]   path: type <class 'list'>
[2025-09-20 17:36:21,886 INFO train.py line 63 65773] 训练集样本数: 8935, 验证集样本数: 2130
[2025-09-20 17:36:22,136 INFO train.py line 69 65773] 模型类型: PointTransformerV3
[2025-09-20 17:36:22,138 INFO train.py line 93 65773] 
===== Epoch 1/100 =====
[2025-09-20 17:36:55,129 INFO train.py line 34 65971] 使用配置文件: configs/wind_shear/pointtransformer_v3.yaml
[2025-09-20 17:36:55,471 INFO train.py line 39 65971] 使用设备: cuda
[2025-09-20 17:36:56,936 INFO train.py line 54 65971] First batch structure (验证collate_fn输出):
[2025-09-20 17:36:56,936 INFO train.py line 57 65971]   offset: shape torch.Size([3]), dtype torch.int64
[2025-09-20 17:36:56,937 INFO train.py line 57 65971]   coord: shape torch.Size([9216, 3]), dtype torch.float32
[2025-09-20 17:36:56,937 INFO train.py line 57 65971]   feat: shape torch.Size([9216, 9]), dtype torch.float32
[2025-09-20 17:36:56,937 INFO train.py line 57 65971]   label: shape torch.Size([9216]), dtype torch.int64
[2025-09-20 17:36:56,937 INFO train.py line 57 65971]   beamaz: shape torch.Size([9216]), dtype torch.float32
[2025-09-20 17:36:56,937 INFO train.py line 57 65971]   grid_size: shape torch.Size([3]), dtype torch.float32
[2025-09-20 17:36:56,937 INFO train.py line 59 65971]   path: type <class 'list'>
[2025-09-20 17:36:56,937 INFO train.py line 63 65971] 训练集样本数: 8935, 验证集样本数: 2130
[2025-09-20 17:36:57,211 INFO train.py line 69 65971] 模型类型: PointTransformerV3
[2025-09-20 17:36:57,212 INFO train.py line 93 65971] 
===== Epoch 1/100 =====
